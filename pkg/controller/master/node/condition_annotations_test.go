package node

import (
	"testing"

	"github.com/harvester/harvester/pkg/util"
	"github.com/harvester/harvester/pkg/util/fakeclients"
	"github.com/stretchr/testify/require"
	corev1 "k8s.io/api/core/v1"
	k8sfake "k8s.io/client-go/kubernetes/fake"
	yaml "sigs.k8s.io/yaml"
)

const (
	nodeConditionFalse = `apiVersion: v1
kind: Node
metadata:
  annotations:
    alpha.kubernetes.io/provided-node-ip: 10.115.52.90
    cluster.x-k8s.io/annotations-from-machine: ""
    cluster.x-k8s.io/cluster-name: local
    cluster.x-k8s.io/cluster-namespace: fleet-local
    cluster.x-k8s.io/labels-from-machine: ""
    cluster.x-k8s.io/machine: custom-8b3d1bdf21ef
    csi.volume.kubernetes.io/nodeid: '{"driver.longhorn.io":"harvester-node-1"}'
    etcd.rke2.cattle.io/local-snapshots-timestamp: "2026-01-19T05:35:10Z"
    etcd.rke2.cattle.io/node-address: 10.115.52.90
    etcd.rke2.cattle.io/node-name: harvester-node-1-9d108e7d
    flannel.alpha.coreos.com/backend-data: '{"VNI":1,"VtepMAC":"0a:7d:b7:39:dc:d1"}'
    flannel.alpha.coreos.com/backend-type: vxlan
    flannel.alpha.coreos.com/kube-subnet-manager: "true"
    flannel.alpha.coreos.com/public-ip: 10.115.52.90
    harvesterhci.io/promote-status: complete
    kubevirt.io/heartbeat: "2026-01-19T05:35:16Z"
    kubevirt.io/ksm-handler-managed: "false"
    management.cattle.io/pod-limits: '{"cpu":"100m","memory":"128Mi"}'
    management.cattle.io/pod-requests: '{"cpu":"1360m","memory":"2240Mi","pods":"12"}'
    node.alpha.kubernetes.io/ttl: "0"
    node.harvesterhci.io/ntp-service: '{"ntpSyncStatus":"synced","currentNtpServers":"0.suse.pool.ntp.org
      1.suse.pool.ntp.org"}'
    rke2.io/encryption-config-hash: start-be0557c28851151a863e012edbe29a29048fb7b5bfd2e9e2a419925db3de3d7f
    rke2.io/hostname: harvester-node-1
    rke2.io/internal-ip: 10.115.52.90
    rke2.io/node-args: '["server","--disable","rke2-snapshot-controller","--disable","rke2-snapshot-controller-crd","--disable","rke2-snapshot-validation-webhook","--agent-token","********","--cni","multus,canal","--kube-controller-manager-arg","cert-dir=/var/lib/rancher/rke2/server/tls/kube-controller-manager","--kube-controller-manager-arg","secure-port=10257","--kube-controller-manager-extra-mount","/var/lib/rancher/rke2/server/tls/kube-controller-manager:/var/lib/rancher/rke2/server/tls/kube-controller-manager","--kube-scheduler-arg","cert-dir=/var/lib/rancher/rke2/server/tls/kube-scheduler","--kube-scheduler-arg","secure-port=10259","--kube-scheduler-extra-mount","/var/lib/rancher/rke2/server/tls/kube-scheduler:/var/lib/rancher/rke2/server/tls/kube-scheduler","--node-label","harvesterhci.io/managed=true","--node-label","rke.cattle.io/machine=d4669472-188d-42e6-86cc-e4b2ddf76c88","--node-name","harvester-node-1","--private-registry","/etc/rancher/rke2/registries.yaml","--server","https://10.115.52.89:9345","--token","********","--kubelet-arg","max-pods=200","--kubelet-arg","system-reserved=cpu=400m","--kubelet-arg","kube-reserved=cpu=600m","--cluster-cidr","10.52.0.0/16","--service-cidr","10.53.0.0/16","--cluster-dns","10.53.0.10","--tls-san","10.115.52.92","--audit-policy-file","/etc/rancher/rke2/config.yaml.d/92-harvester-kube-audit-policy.yaml","--nonroot-devices","true","--apiVersion","audit.k8s.io/v1","--kind","Policy","--omitStages","ResponseStarted","--omitStages","ResponseComplete","--rules","[{level
      Metadata} {verbs [create delete patch]} {omitStages [ResponseStarted ResponseComplete]}]"]'
    rke2.io/node-env: '{"RKE2_DATA_DIR":"/var/lib/rancher/rke2"}'
    volumes.kubernetes.io/controller-managed-attach-detach: "true"
  creationTimestamp: "2026-01-16T02:52:48Z"
  finalizers:
  - wrangler.cattle.io/harvester-network-manager-node-controller
  - wrangler.cattle.io/node
  - wrangler.cattle.io/managed-etcd-controller
  - wrangler.cattle.io/maintain-node-controller
  - wrangler.cattle.io/node-remove-controller
  labels:
    beta.kubernetes.io/arch: amd64
    beta.kubernetes.io/instance-type: rke2
    beta.kubernetes.io/os: linux
    cpu-feature.node.kubevirt.io/abm: "true"
    cpu-feature.node.kubevirt.io/aes: "true"
    cpu-feature.node.kubevirt.io/amd-ssbd: "true"
    cpu-feature.node.kubevirt.io/amd-stibp: "true"
    cpu-feature.node.kubevirt.io/apic: "true"
    cpu-feature.node.kubevirt.io/arat: "true"
    cpu-feature.node.kubevirt.io/arch-capabilities: "true"
    cpu-feature.node.kubevirt.io/avx: "true"
    cpu-feature.node.kubevirt.io/avx2: "true"
    cpu-feature.node.kubevirt.io/bmi1: "true"
    cpu-feature.node.kubevirt.io/bmi2: "true"
    cpu-feature.node.kubevirt.io/clflush: "true"
    cpu-feature.node.kubevirt.io/cmov: "true"
    cpu-feature.node.kubevirt.io/cx8: "true"
    cpu-feature.node.kubevirt.io/cx16: "true"
    cpu-feature.node.kubevirt.io/de: "true"
    cpu-feature.node.kubevirt.io/erms: "true"
    cpu-feature.node.kubevirt.io/f16c: "true"
    cpu-feature.node.kubevirt.io/flush-l1d: "true"
    cpu-feature.node.kubevirt.io/fma: "true"
    cpu-feature.node.kubevirt.io/fpu: "true"
    cpu-feature.node.kubevirt.io/fsgsbase: "true"
    cpu-feature.node.kubevirt.io/fxsr: "true"
    cpu-feature.node.kubevirt.io/gds-no: "true"
    cpu-feature.node.kubevirt.io/hypervisor: "true"
    cpu-feature.node.kubevirt.io/ibpb: "true"
    cpu-feature.node.kubevirt.io/ibrs: "true"
    cpu-feature.node.kubevirt.io/invpcid: "true"
    cpu-feature.node.kubevirt.io/lahf_lm: "true"
    cpu-feature.node.kubevirt.io/lm: "true"
    cpu-feature.node.kubevirt.io/mca: "true"
    cpu-feature.node.kubevirt.io/mce: "true"
    cpu-feature.node.kubevirt.io/md-clear: "true"
    cpu-feature.node.kubevirt.io/mmx: "true"
    cpu-feature.node.kubevirt.io/movbe: "true"
    cpu-feature.node.kubevirt.io/msr: "true"
    cpu-feature.node.kubevirt.io/mtrr: "true"
    cpu-feature.node.kubevirt.io/nx: "true"
    cpu-feature.node.kubevirt.io/pae: "true"
    cpu-feature.node.kubevirt.io/pat: "true"
    cpu-feature.node.kubevirt.io/pcid: "true"
    cpu-feature.node.kubevirt.io/pclmuldq: "true"
    cpu-feature.node.kubevirt.io/pdcm: "true"
    cpu-feature.node.kubevirt.io/pdpe1gb: "true"
    cpu-feature.node.kubevirt.io/pge: "true"
    cpu-feature.node.kubevirt.io/pni: "true"
    cpu-feature.node.kubevirt.io/popcnt: "true"
    cpu-feature.node.kubevirt.io/pschange-mc-no: "true"
    cpu-feature.node.kubevirt.io/pse: "true"
    cpu-feature.node.kubevirt.io/pse36: "true"
    cpu-feature.node.kubevirt.io/rdrand: "true"
    cpu-feature.node.kubevirt.io/rdtscp: "true"
    cpu-feature.node.kubevirt.io/rfds-no: "true"
    cpu-feature.node.kubevirt.io/sep: "true"
    cpu-feature.node.kubevirt.io/skip-l1dfl-vmentry: "true"
    cpu-feature.node.kubevirt.io/smep: "true"
    cpu-feature.node.kubevirt.io/spec-ctrl: "true"
    cpu-feature.node.kubevirt.io/ss: "true"
    cpu-feature.node.kubevirt.io/ssbd: "true"
    cpu-feature.node.kubevirt.io/sse: "true"
    cpu-feature.node.kubevirt.io/sse2: "true"
    cpu-feature.node.kubevirt.io/sse4.1: "true"
    cpu-feature.node.kubevirt.io/sse4.2: "true"
    cpu-feature.node.kubevirt.io/ssse3: "true"
    cpu-feature.node.kubevirt.io/stibp: "true"
    cpu-feature.node.kubevirt.io/syscall: "true"
    cpu-feature.node.kubevirt.io/tsc: "true"
    cpu-feature.node.kubevirt.io/tsc-deadline: "true"
    cpu-feature.node.kubevirt.io/tsc_adjust: "true"
    cpu-feature.node.kubevirt.io/umip: "true"
    cpu-feature.node.kubevirt.io/vme: "true"
    cpu-feature.node.kubevirt.io/vmx: "true"
    cpu-feature.node.kubevirt.io/vmx-activity-hlt: "true"
    cpu-feature.node.kubevirt.io/vmx-activity-wait-sipi: "true"
    cpu-feature.node.kubevirt.io/vmx-apicv-register: "true"
    cpu-feature.node.kubevirt.io/vmx-apicv-vid: "true"
    cpu-feature.node.kubevirt.io/vmx-apicv-x2apic: "true"
    cpu-feature.node.kubevirt.io/vmx-apicv-xapic: "true"
    cpu-feature.node.kubevirt.io/vmx-cr3-load-noexit: "true"
    cpu-feature.node.kubevirt.io/vmx-cr3-store-noexit: "true"
    cpu-feature.node.kubevirt.io/vmx-cr8-load-exit: "true"
    cpu-feature.node.kubevirt.io/vmx-cr8-store-exit: "true"
    cpu-feature.node.kubevirt.io/vmx-desc-exit: "true"
    cpu-feature.node.kubevirt.io/vmx-entry-ia32e-mode: "true"
    cpu-feature.node.kubevirt.io/vmx-entry-load-efer: "true"
    cpu-feature.node.kubevirt.io/vmx-entry-load-pat: "true"
    cpu-feature.node.kubevirt.io/vmx-entry-load-perf-global-ctrl: "true"
    cpu-feature.node.kubevirt.io/vmx-entry-noload-debugctl: "true"
    cpu-feature.node.kubevirt.io/vmx-ept: "true"
    cpu-feature.node.kubevirt.io/vmx-ept-1gb: "true"
    cpu-feature.node.kubevirt.io/vmx-ept-2mb: "true"
    cpu-feature.node.kubevirt.io/vmx-ept-execonly: "true"
    cpu-feature.node.kubevirt.io/vmx-eptad: "true"
    cpu-feature.node.kubevirt.io/vmx-eptp-switching: "true"
    cpu-feature.node.kubevirt.io/vmx-exit-ack-intr: "true"
    cpu-feature.node.kubevirt.io/vmx-exit-load-efer: "true"
    cpu-feature.node.kubevirt.io/vmx-exit-load-pat: "true"
    cpu-feature.node.kubevirt.io/vmx-exit-load-perf-global-ctrl: "true"
    cpu-feature.node.kubevirt.io/vmx-exit-nosave-debugctl: "true"
    cpu-feature.node.kubevirt.io/vmx-exit-save-efer: "true"
    cpu-feature.node.kubevirt.io/vmx-exit-save-pat: "true"
    cpu-feature.node.kubevirt.io/vmx-exit-save-preemption-timer: "true"
    cpu-feature.node.kubevirt.io/vmx-flexpriority: "true"
    cpu-feature.node.kubevirt.io/vmx-hlt-exit: "true"
    cpu-feature.node.kubevirt.io/vmx-ins-outs: "true"
    cpu-feature.node.kubevirt.io/vmx-intr-exit: "true"
    cpu-feature.node.kubevirt.io/vmx-invept: "true"
    cpu-feature.node.kubevirt.io/vmx-invept-all-context: "true"
    cpu-feature.node.kubevirt.io/vmx-invept-single-context: "true"
    cpu-feature.node.kubevirt.io/vmx-invlpg-exit: "true"
    cpu-feature.node.kubevirt.io/vmx-invpcid-exit: "true"
    cpu-feature.node.kubevirt.io/vmx-invvpid: "true"
    cpu-feature.node.kubevirt.io/vmx-invvpid-all-context: "true"
    cpu-feature.node.kubevirt.io/vmx-invvpid-single-addr: "true"
    cpu-feature.node.kubevirt.io/vmx-invvpid-single-context-noglobals: "true"
    cpu-feature.node.kubevirt.io/vmx-io-bitmap: "true"
    cpu-feature.node.kubevirt.io/vmx-io-exit: "true"
    cpu-feature.node.kubevirt.io/vmx-monitor-exit: "true"
    cpu-feature.node.kubevirt.io/vmx-movdr-exit: "true"
    cpu-feature.node.kubevirt.io/vmx-msr-bitmap: "true"
    cpu-feature.node.kubevirt.io/vmx-mtf: "true"
    cpu-feature.node.kubevirt.io/vmx-mwait-exit: "true"
    cpu-feature.node.kubevirt.io/vmx-nmi-exit: "true"
    cpu-feature.node.kubevirt.io/vmx-page-walk-4: "true"
    cpu-feature.node.kubevirt.io/vmx-pause-exit: "true"
    cpu-feature.node.kubevirt.io/vmx-pml: "true"
    cpu-feature.node.kubevirt.io/vmx-posted-intr: "true"
    cpu-feature.node.kubevirt.io/vmx-preemption-timer: "true"
    cpu-feature.node.kubevirt.io/vmx-rdpmc-exit: "true"
    cpu-feature.node.kubevirt.io/vmx-rdrand-exit: "true"
    cpu-feature.node.kubevirt.io/vmx-rdtsc-exit: "true"
    cpu-feature.node.kubevirt.io/vmx-rdtscp-exit: "true"
    cpu-feature.node.kubevirt.io/vmx-secondary-ctls: "true"
    cpu-feature.node.kubevirt.io/vmx-shadow-vmcs: "true"
    cpu-feature.node.kubevirt.io/vmx-store-lma: "true"
    cpu-feature.node.kubevirt.io/vmx-true-ctls: "true"
    cpu-feature.node.kubevirt.io/vmx-tsc-offset: "true"
    cpu-feature.node.kubevirt.io/vmx-unrestricted-guest: "true"
    cpu-feature.node.kubevirt.io/vmx-vintr-pending: "true"
    cpu-feature.node.kubevirt.io/vmx-vmfunc: "true"
    cpu-feature.node.kubevirt.io/vmx-vmwrite-vmexit-fields: "true"
    cpu-feature.node.kubevirt.io/vmx-vnmi: "true"
    cpu-feature.node.kubevirt.io/vmx-vnmi-pending: "true"
    cpu-feature.node.kubevirt.io/vmx-vpid: "true"
    cpu-feature.node.kubevirt.io/vmx-wbinvd-exit: "true"
    cpu-feature.node.kubevirt.io/x2apic: "true"
    cpu-feature.node.kubevirt.io/xsave: "true"
    cpu-feature.node.kubevirt.io/xsaveopt: "true"
    cpu-model-migration.node.kubevirt.io/Haswell-noTSX: "true"
    cpu-model-migration.node.kubevirt.io/Haswell-noTSX-IBRS: "true"
    cpu-model-migration.node.kubevirt.io/Haswell-v2: "true"
    cpu-model-migration.node.kubevirt.io/Haswell-v4: "true"
    cpu-model-migration.node.kubevirt.io/IvyBridge: "true"
    cpu-model-migration.node.kubevirt.io/IvyBridge-IBRS: "true"
    cpu-model-migration.node.kubevirt.io/IvyBridge-v1: "true"
    cpu-model-migration.node.kubevirt.io/IvyBridge-v2: "true"
    cpu-model-migration.node.kubevirt.io/Nehalem: "true"
    cpu-model-migration.node.kubevirt.io/Nehalem-IBRS: "true"
    cpu-model-migration.node.kubevirt.io/Nehalem-v1: "true"
    cpu-model-migration.node.kubevirt.io/Nehalem-v2: "true"
    cpu-model-migration.node.kubevirt.io/Penryn: "true"
    cpu-model-migration.node.kubevirt.io/Penryn-v1: "true"
    cpu-model-migration.node.kubevirt.io/SandyBridge: "true"
    cpu-model-migration.node.kubevirt.io/SandyBridge-IBRS: "true"
    cpu-model-migration.node.kubevirt.io/SandyBridge-v1: "true"
    cpu-model-migration.node.kubevirt.io/SandyBridge-v2: "true"
    cpu-model-migration.node.kubevirt.io/Westmere: "true"
    cpu-model-migration.node.kubevirt.io/Westmere-IBRS: "true"
    cpu-model-migration.node.kubevirt.io/Westmere-v1: "true"
    cpu-model-migration.node.kubevirt.io/Westmere-v2: "true"
    cpu-model.node.kubevirt.io/Haswell-noTSX: "true"
    cpu-model.node.kubevirt.io/Haswell-noTSX-IBRS: "true"
    cpu-model.node.kubevirt.io/Haswell-v2: "true"
    cpu-model.node.kubevirt.io/Haswell-v4: "true"
    cpu-model.node.kubevirt.io/IvyBridge: "true"
    cpu-model.node.kubevirt.io/IvyBridge-IBRS: "true"
    cpu-model.node.kubevirt.io/IvyBridge-v1: "true"
    cpu-model.node.kubevirt.io/IvyBridge-v2: "true"
    cpu-model.node.kubevirt.io/Nehalem: "true"
    cpu-model.node.kubevirt.io/Nehalem-IBRS: "true"
    cpu-model.node.kubevirt.io/Nehalem-v1: "true"
    cpu-model.node.kubevirt.io/Nehalem-v2: "true"
    cpu-model.node.kubevirt.io/Penryn: "true"
    cpu-model.node.kubevirt.io/Penryn-v1: "true"
    cpu-model.node.kubevirt.io/SandyBridge: "true"
    cpu-model.node.kubevirt.io/SandyBridge-IBRS: "true"
    cpu-model.node.kubevirt.io/SandyBridge-v1: "true"
    cpu-model.node.kubevirt.io/SandyBridge-v2: "true"
    cpu-model.node.kubevirt.io/Westmere: "true"
    cpu-model.node.kubevirt.io/Westmere-IBRS: "true"
    cpu-model.node.kubevirt.io/Westmere-v1: "true"
    cpu-model.node.kubevirt.io/Westmere-v2: "true"
    cpu-vendor.node.kubevirt.io/Intel: "true"
    cpumanager: "false"
    harvesterhci.io/managed: "true"
    host-model-cpu.node.kubevirt.io/Haswell-noTSX-IBRS: "true"
    host-model-required-features.node.kubevirt.io/abm: "true"
    host-model-required-features.node.kubevirt.io/amd-ssbd: "true"
    host-model-required-features.node.kubevirt.io/amd-stibp: "true"
    host-model-required-features.node.kubevirt.io/arat: "true"
    host-model-required-features.node.kubevirt.io/arch-capabilities: "true"
    host-model-required-features.node.kubevirt.io/f16c: "true"
    host-model-required-features.node.kubevirt.io/flush-l1d: "true"
    host-model-required-features.node.kubevirt.io/gds-no: "true"
    host-model-required-features.node.kubevirt.io/hypervisor: "true"
    host-model-required-features.node.kubevirt.io/ibpb: "true"
    host-model-required-features.node.kubevirt.io/ibrs: "true"
    host-model-required-features.node.kubevirt.io/md-clear: "true"
    host-model-required-features.node.kubevirt.io/pdcm: "true"
    host-model-required-features.node.kubevirt.io/pdpe1gb: "true"
    host-model-required-features.node.kubevirt.io/pschange-mc-no: "true"
    host-model-required-features.node.kubevirt.io/rdrand: "true"
    host-model-required-features.node.kubevirt.io/rfds-no: "true"
    host-model-required-features.node.kubevirt.io/skip-l1dfl-vmentry: "true"
    host-model-required-features.node.kubevirt.io/ss: "true"
    host-model-required-features.node.kubevirt.io/ssbd: "true"
    host-model-required-features.node.kubevirt.io/stibp: "true"
    host-model-required-features.node.kubevirt.io/tsc_adjust: "true"
    host-model-required-features.node.kubevirt.io/umip: "true"
    host-model-required-features.node.kubevirt.io/vme: "true"
    host-model-required-features.node.kubevirt.io/vmx: "true"
    host-model-required-features.node.kubevirt.io/vmx-activity-hlt: "true"
    host-model-required-features.node.kubevirt.io/vmx-activity-wait-sipi: "true"
    host-model-required-features.node.kubevirt.io/vmx-apicv-register: "true"
    host-model-required-features.node.kubevirt.io/vmx-apicv-vid: "true"
    host-model-required-features.node.kubevirt.io/vmx-apicv-x2apic: "true"
    host-model-required-features.node.kubevirt.io/vmx-apicv-xapic: "true"
    host-model-required-features.node.kubevirt.io/vmx-cr3-load-noexit: "true"
    host-model-required-features.node.kubevirt.io/vmx-cr3-store-noexit: "true"
    host-model-required-features.node.kubevirt.io/vmx-cr8-load-exit: "true"
    host-model-required-features.node.kubevirt.io/vmx-cr8-store-exit: "true"
    host-model-required-features.node.kubevirt.io/vmx-desc-exit: "true"
    host-model-required-features.node.kubevirt.io/vmx-entry-ia32e-mode: "true"
    host-model-required-features.node.kubevirt.io/vmx-entry-load-efer: "true"
    host-model-required-features.node.kubevirt.io/vmx-entry-load-pat: "true"
    host-model-required-features.node.kubevirt.io/vmx-entry-load-perf-global-ctrl: "true"
    host-model-required-features.node.kubevirt.io/vmx-entry-noload-debugctl: "true"
    host-model-required-features.node.kubevirt.io/vmx-ept: "true"
    host-model-required-features.node.kubevirt.io/vmx-ept-1gb: "true"
    host-model-required-features.node.kubevirt.io/vmx-ept-2mb: "true"
    host-model-required-features.node.kubevirt.io/vmx-ept-execonly: "true"
    host-model-required-features.node.kubevirt.io/vmx-eptad: "true"
    host-model-required-features.node.kubevirt.io/vmx-eptp-switching: "true"
    host-model-required-features.node.kubevirt.io/vmx-exit-ack-intr: "true"
    host-model-required-features.node.kubevirt.io/vmx-exit-load-efer: "true"
    host-model-required-features.node.kubevirt.io/vmx-exit-load-pat: "true"
    host-model-required-features.node.kubevirt.io/vmx-exit-load-perf-global-ctrl: "true"
    host-model-required-features.node.kubevirt.io/vmx-exit-nosave-debugctl: "true"
    host-model-required-features.node.kubevirt.io/vmx-exit-save-efer: "true"
    host-model-required-features.node.kubevirt.io/vmx-exit-save-pat: "true"
    host-model-required-features.node.kubevirt.io/vmx-exit-save-preemption-timer: "true"
    host-model-required-features.node.kubevirt.io/vmx-flexpriority: "true"
    host-model-required-features.node.kubevirt.io/vmx-hlt-exit: "true"
    host-model-required-features.node.kubevirt.io/vmx-ins-outs: "true"
    host-model-required-features.node.kubevirt.io/vmx-intr-exit: "true"
    host-model-required-features.node.kubevirt.io/vmx-invept: "true"
    host-model-required-features.node.kubevirt.io/vmx-invept-all-context: "true"
    host-model-required-features.node.kubevirt.io/vmx-invept-single-context: "true"
    host-model-required-features.node.kubevirt.io/vmx-invlpg-exit: "true"
    host-model-required-features.node.kubevirt.io/vmx-invpcid-exit: "true"
    host-model-required-features.node.kubevirt.io/vmx-invvpid: "true"
    host-model-required-features.node.kubevirt.io/vmx-invvpid-all-context: "true"
    host-model-required-features.node.kubevirt.io/vmx-invvpid-single-addr: "true"
    host-model-required-features.node.kubevirt.io/vmx-invvpid-single-context-noglobals: "true"
    host-model-required-features.node.kubevirt.io/vmx-io-bitmap: "true"
    host-model-required-features.node.kubevirt.io/vmx-io-exit: "true"
    host-model-required-features.node.kubevirt.io/vmx-monitor-exit: "true"
    host-model-required-features.node.kubevirt.io/vmx-movdr-exit: "true"
    host-model-required-features.node.kubevirt.io/vmx-msr-bitmap: "true"
    host-model-required-features.node.kubevirt.io/vmx-mtf: "true"
    host-model-required-features.node.kubevirt.io/vmx-mwait-exit: "true"
    host-model-required-features.node.kubevirt.io/vmx-nmi-exit: "true"
    host-model-required-features.node.kubevirt.io/vmx-page-walk-4: "true"
    host-model-required-features.node.kubevirt.io/vmx-pause-exit: "true"
    host-model-required-features.node.kubevirt.io/vmx-pml: "true"
    host-model-required-features.node.kubevirt.io/vmx-posted-intr: "true"
    host-model-required-features.node.kubevirt.io/vmx-preemption-timer: "true"
    host-model-required-features.node.kubevirt.io/vmx-rdpmc-exit: "true"
    host-model-required-features.node.kubevirt.io/vmx-rdrand-exit: "true"
    host-model-required-features.node.kubevirt.io/vmx-rdtsc-exit: "true"
    host-model-required-features.node.kubevirt.io/vmx-rdtscp-exit: "true"
    host-model-required-features.node.kubevirt.io/vmx-secondary-ctls: "true"
    host-model-required-features.node.kubevirt.io/vmx-shadow-vmcs: "true"
    host-model-required-features.node.kubevirt.io/vmx-store-lma: "true"
    host-model-required-features.node.kubevirt.io/vmx-true-ctls: "true"
    host-model-required-features.node.kubevirt.io/vmx-tsc-offset: "true"
    host-model-required-features.node.kubevirt.io/vmx-unrestricted-guest: "true"
    host-model-required-features.node.kubevirt.io/vmx-vintr-pending: "true"
    host-model-required-features.node.kubevirt.io/vmx-vmfunc: "true"
    host-model-required-features.node.kubevirt.io/vmx-vmwrite-vmexit-fields: "true"
    host-model-required-features.node.kubevirt.io/vmx-vnmi: "true"
    host-model-required-features.node.kubevirt.io/vmx-vnmi-pending: "true"
    host-model-required-features.node.kubevirt.io/vmx-vpid: "true"
    host-model-required-features.node.kubevirt.io/vmx-wbinvd-exit: "true"
    host-model-required-features.node.kubevirt.io/xsaveopt: "true"
    hyperv.node.kubevirt.io/base: "true"
    hyperv.node.kubevirt.io/frequencies: "true"
    hyperv.node.kubevirt.io/ipi: "true"
    hyperv.node.kubevirt.io/reenlightenment: "true"
    hyperv.node.kubevirt.io/reset: "true"
    hyperv.node.kubevirt.io/runtime: "true"
    hyperv.node.kubevirt.io/synic: "true"
    hyperv.node.kubevirt.io/synic2: "true"
    hyperv.node.kubevirt.io/synictimer: "true"
    hyperv.node.kubevirt.io/time: "true"
    hyperv.node.kubevirt.io/tlbflush: "true"
    hyperv.node.kubevirt.io/vpindex: "true"
    kubernetes.io/arch: amd64
    kubernetes.io/hostname: harvester-node-1
    kubernetes.io/os: linux
    kubevirt.io/ksm-enabled: "false"
    kubevirt.io/schedulable: "false"
    machine-type.node.kubevirt.io/isapc: "true"
    machine-type.node.kubevirt.io/microvm: "true"
    machine-type.node.kubevirt.io/nitro-enclave: "true"
    machine-type.node.kubevirt.io/pc: "true"
    machine-type.node.kubevirt.io/pc-i440fx-2.4: "true"
    machine-type.node.kubevirt.io/pc-i440fx-2.5: "true"
    machine-type.node.kubevirt.io/pc-i440fx-2.6: "true"
    machine-type.node.kubevirt.io/pc-i440fx-2.7: "true"
    machine-type.node.kubevirt.io/pc-i440fx-2.8: "true"
    machine-type.node.kubevirt.io/pc-i440fx-2.9: "true"
    machine-type.node.kubevirt.io/pc-i440fx-2.10: "true"
    machine-type.node.kubevirt.io/pc-i440fx-2.11: "true"
    machine-type.node.kubevirt.io/pc-i440fx-2.12: "true"
    machine-type.node.kubevirt.io/pc-i440fx-3.0: "true"
    machine-type.node.kubevirt.io/pc-i440fx-3.1: "true"
    machine-type.node.kubevirt.io/pc-i440fx-4.0: "true"
    machine-type.node.kubevirt.io/pc-i440fx-4.1: "true"
    machine-type.node.kubevirt.io/pc-i440fx-4.2: "true"
    machine-type.node.kubevirt.io/pc-i440fx-5.0: "true"
    machine-type.node.kubevirt.io/pc-i440fx-5.1: "true"
    machine-type.node.kubevirt.io/pc-i440fx-5.2: "true"
    machine-type.node.kubevirt.io/pc-i440fx-6.0: "true"
    machine-type.node.kubevirt.io/pc-i440fx-6.1: "true"
    machine-type.node.kubevirt.io/pc-i440fx-6.2: "true"
    machine-type.node.kubevirt.io/pc-i440fx-7.0: "true"
    machine-type.node.kubevirt.io/pc-i440fx-7.1: "true"
    machine-type.node.kubevirt.io/pc-i440fx-7.2: "true"
    machine-type.node.kubevirt.io/pc-i440fx-8.0: "true"
    machine-type.node.kubevirt.io/pc-i440fx-8.1: "true"
    machine-type.node.kubevirt.io/pc-i440fx-8.2: "true"
    machine-type.node.kubevirt.io/pc-i440fx-9.0: "true"
    machine-type.node.kubevirt.io/pc-i440fx-9.1: "true"
    machine-type.node.kubevirt.io/pc-i440fx-9.2: "true"
    machine-type.node.kubevirt.io/pc-q35-2.4: "true"
    machine-type.node.kubevirt.io/pc-q35-2.5: "true"
    machine-type.node.kubevirt.io/pc-q35-2.6: "true"
    machine-type.node.kubevirt.io/pc-q35-2.7: "true"
    machine-type.node.kubevirt.io/pc-q35-2.8: "true"
    machine-type.node.kubevirt.io/pc-q35-2.9: "true"
    machine-type.node.kubevirt.io/pc-q35-2.10: "true"
    machine-type.node.kubevirt.io/pc-q35-2.11: "true"
    machine-type.node.kubevirt.io/pc-q35-2.12: "true"
    machine-type.node.kubevirt.io/pc-q35-3.0: "true"
    machine-type.node.kubevirt.io/pc-q35-3.1: "true"
    machine-type.node.kubevirt.io/pc-q35-4.0: "true"
    machine-type.node.kubevirt.io/pc-q35-4.0.1: "true"
    machine-type.node.kubevirt.io/pc-q35-4.1: "true"
    machine-type.node.kubevirt.io/pc-q35-4.2: "true"
    machine-type.node.kubevirt.io/pc-q35-5.0: "true"
    machine-type.node.kubevirt.io/pc-q35-5.1: "true"
    machine-type.node.kubevirt.io/pc-q35-5.2: "true"
    machine-type.node.kubevirt.io/pc-q35-6.0: "true"
    machine-type.node.kubevirt.io/pc-q35-6.1: "true"
    machine-type.node.kubevirt.io/pc-q35-6.2: "true"
    machine-type.node.kubevirt.io/pc-q35-7.0: "true"
    machine-type.node.kubevirt.io/pc-q35-7.1: "true"
    machine-type.node.kubevirt.io/pc-q35-7.2: "true"
    machine-type.node.kubevirt.io/pc-q35-8.0: "true"
    machine-type.node.kubevirt.io/pc-q35-8.1: "true"
    machine-type.node.kubevirt.io/pc-q35-8.2: "true"
    machine-type.node.kubevirt.io/pc-q35-9.0: "true"
    machine-type.node.kubevirt.io/pc-q35-9.1: "true"
    machine-type.node.kubevirt.io/pc-q35-9.2: "true"
    machine-type.node.kubevirt.io/q35: "true"
    machine-type.node.kubevirt.io/xenfv: "true"
    machine-type.node.kubevirt.io/xenfv-3.1: "true"
    machine-type.node.kubevirt.io/xenfv-4.2: "true"
    machine-type.node.kubevirt.io/xenpv: "true"
    machine-type.node.kubevirt.io/xenpvh: "true"
    network.harvesterhci.io/cn: "true"
    network.harvesterhci.io/mgmt: "true"
    network.harvesterhci.io/vlanconfig: nc
    node-role.kubernetes.io/control-plane: "true"
    node-role.kubernetes.io/etcd: "true"
    node.kubernetes.io/instance-type: rke2
    plan.upgrade.cattle.io/sync-additional-ca: 2c27af4f7e139d7c15346edc0adb200edade07eef796ef2c41ef923b
    plan.upgrade.cattle.io/system-agent-upgrader: cab0e3bd454d91beec8ee44425add5c2cd494696a84c38239deb82f1
    rke.cattle.io/machine: d4669472-188d-42e6-86cc-e4b2ddf76c88
  name: harvester-node-1
  resourceVersion: "5610701"
  uid: 9221811e-1f0e-4958-9aba-468444971fcb
spec:
  podCIDR: 10.52.1.0/24
  podCIDRs:
  - 10.52.1.0/24
  providerID: rke2://harvester-node-1
  taints:
  - effect: NoSchedule
    key: node.kubernetes.io/unreachable
    timeAdded: "2026-01-19T05:36:00Z"
  - effect: NoExecute
    key: node.kubernetes.io/unreachable
    timeAdded: "2026-01-19T05:36:00Z"
  - effect: NoSchedule
    key: kubevirt.io/drain
  - effect: NoExecute
    key: node.kubernetes.io/out-of-service
status:
  addresses:
  - address: 10.115.52.90
    type: InternalIP
  - address: harvester-node-1
    type: Hostname
  allocatable:
    cpu: "11"
    devices.kubevirt.io/kvm: 1k
    devices.kubevirt.io/tun: 1k
    devices.kubevirt.io/vhost-net: 1k
    ephemeral-storage: "276921388020"
    hugepages-1Gi: "0"
    hugepages-2Mi: "0"
    memory: 22392912Ki
    pods: "200"
  capacity:
    cpu: "12"
    devices.kubevirt.io/kvm: 1k
    devices.kubevirt.io/tun: 1k
    devices.kubevirt.io/vhost-net: 1k
    ephemeral-storage: 284664256Ki
    hugepages-1Gi: "0"
    hugepages-2Mi: "0"
    memory: 22392912Ki
    pods: "200"
  conditions:
  - lastHeartbeatTime: "2026-01-20T22:55:24Z"
    lastTransitionTime: "2026-01-16T02:57:23Z"
    message: Node is a voting member of the etcd cluster
    reason: MemberNotLearner
    status: "True"
    type: EtcdIsVoter
  - lastHeartbeatTime: "2026-01-16T02:53:47Z"
    lastTransitionTime: "2026-01-16T02:53:47Z"
    message: Flannel is running on this node
    reason: FlannelIsUp
    status: "False"
    type: NetworkUnavailable
  - lastHeartbeatTime: "2026-01-19T05:31:34Z"
    lastTransitionTime: "2026-01-19T05:36:00Z"
    message: Kubelet stopped posting node status.
    reason: NodeStatusUnknown
    status: Unknown
    type: MemoryPressure
  - lastHeartbeatTime: "2026-01-19T05:31:34Z"
    lastTransitionTime: "2026-01-19T05:36:00Z"
    message: Kubelet stopped posting node status.
    reason: NodeStatusUnknown
    status: Unknown
    type: DiskPressure
  - lastHeartbeatTime: "2026-01-19T05:31:34Z"
    lastTransitionTime: "2026-01-19T05:36:00Z"
    message: Kubelet stopped posting node status.
    reason: NodeStatusUnknown
    status: Unknown
    type: PIDPressure
  - lastHeartbeatTime: "2026-01-19T05:31:34Z"
    lastTransitionTime: "2026-01-19T05:36:00Z"
    message: Kubelet stopped posting node status.
    reason: NodeStatusUnknown
    status: Unknown
    type: Ready
  - lastHeartbeatTime: "2026-01-19T05:39:24Z"
    lastTransitionTime: "2026-01-19T05:36:19Z"
    message: Node is draining due to kubelet/node not ready.
    reason: HarvesterNodeIsDraining
    status: "False"
    type: Drained
  daemonEndpoints:
    kubeletEndpoint:
      Port: 10250
  features:
    supplementalGroupsPolicy: true
  images:
  - names:
    - docker.io/rancher/rancher:v2.13.0
    sizeBytes: 1780569233
  - names:
    - docker.io/longhornio/longhorn-instance-manager:v1.10.1
    sizeBytes: 1358647745
  - names:
    - docker.io/rancher/rancher-agent:v2.13.0
    sizeBytes: 840070356
  - names:
    - docker.io/kubeovn/kube-ovn:v1.14.10
    sizeBytes: 766595147
  - names:
    - registry.suse.com/suse/sles/15.7/libguestfs-tools:1.6.3-150700.3.13.1
    sizeBytes: 719820434
  - names:
    - docker.io/rancher/nginx-ingress-controller:v1.13.4-hardened1
    sizeBytes: 707490001
  - names:
    - docker.io/rancher/hardened-calico:v3.30.3-build20251015
    sizeBytes: 685524019
  - names:
    - docker.io/rancher/hardened-kubernetes:v1.34.2-rke2r1-build20251112
    sizeBytes: 640304363
  - names:
    - docker.io/rancher/mirrored-grafana-grafana:11.5.5
    sizeBytes: 595775533
  - names:
    - docker.io/rancher/harvester-upgrade:f601d3a5
    - docker.io/rancher/harvester-upgrade:v1.7-f601d3a5-head
    - docker.io/rancher/harvester-upgrade:v1.7-head
    sizeBytes: 539380404
  - names:
    - registry.suse.com/suse/sles/15.7/virt-launcher:1.6.3-150700.3.13.1
    sizeBytes: 536303999
  - names:
    - docker.io/longhornio/longhorn-engine:v1.10.1
    sizeBytes: 401541994
  - names:
    - docker.io/longhornio/backing-image-manager:v1.10.1
    sizeBytes: 396337321
  - names:
    - docker.io/rancher/mirrored-kube-logging-fluentd:v1.16-4.10-full
    sizeBytes: 388373272
  - names:
    - docker.io/rancher/shell:v0.6.0
    sizeBytes: 361840174
  - names:
    - docker.io/rancher/shell:v0.5.0
    sizeBytes: 353043502
  - names:
    - registry.suse.com/suse/sles/15.7/cdi-importer:1.62.0-150700.9.3.1
    sizeBytes: 344543711
  - names:
    - docker.io/longhornio/longhorn-manager:v1.10.1-hotfix-2
    sizeBytes: 340198509
  - names:
    - docker.io/rancher/harvester:v1.7-head
    sizeBytes: 338368313
  - names:
    - docker.io/longhornio/longhorn-manager:v1.10.1
    sizeBytes: 330481257
  - names:
    - docker.io/rancher/fleet:v0.14.0
    sizeBytes: 319225891
  - names:
    - docker.io/rancher/rke2-runtime:v1.34.2-rke2r1
    sizeBytes: 306299220
  - names:
    - docker.io/rancher/prom-prometheus:v3.2.1
    sizeBytes: 296367903
  - names:
    - docker.io/rancher/harvester-vm-import-controller:v1.7.0
    sizeBytes: 293606461
  - names:
    - docker.io/rancher/harvester-pcidevices:v1.7.0
    sizeBytes: 266649560
  - names:
    - docker.io/longhornio/longhorn-cli:v1.10.1
    sizeBytes: 255924943
  - names:
    - registry.suse.com/suse/sles/15.7/virt-handler:1.6.3-150700.3.13.1
    sizeBytes: 254717336
  - names:
    - docker.io/rancher/harvester-webhook:v1.7-head
    sizeBytes: 251790207
  - names:
    - docker.io/rancher/kuberlr-kubectl:v5.0.0
    sizeBytes: 251571844
  - names:
    - docker.io/rancher/support-bundle-kit:v0.0.74
    sizeBytes: 251150429
  - names:
    - docker.io/longhornio/support-bundle-kit:v0.0.71
    sizeBytes: 251072091
  - names:
    - docker.io/longhornio/longhorn-share-manager:v1.10.1
    sizeBytes: 241758234
  - names:
    - docker.io/rancher/harvester-seeder:v1.7.0
    sizeBytes: 229291817
  - names:
    - docker.io/rancher/system-agent:v0.3.14-suc
    sizeBytes: 218366310
  - names:
    - docker.io/longhornio/longhorn-ui:v1.10.1
    sizeBytes: 215792836
  - names:
    - docker.io/rancher/harvester-networkfs-manager:v1.7.0
    sizeBytes: 213212315
  - names:
    - docker.io/rancher/harvester-network-controller:v1.7.0
    sizeBytes: 211940539
  - names:
    - docker.io/rancher/harvester-kubeovn-operator:v1.14.10-dev.1
    sizeBytes: 211835920
  - names:
    - registry.suse.com/suse/sles/15.7/cdi-uploadserver:1.62.0-150700.9.3.1
    sizeBytes: 207361342
  - names:
    - docker.io/rancher/harvester-node-disk-manager:v1.7.0
    sizeBytes: 206875815
  - names:
    - registry.suse.com/suse/sles/15.7/virt-operator:1.6.3-150700.3.13.1
    sizeBytes: 205596893
  - names:
    - ghcr.io/k8snetworkplumbingwg/whereabouts:v0.9.2
    sizeBytes: 204231357
  - names:
    - registry.suse.com/suse/sles/15.7/virt-api:1.6.3-150700.3.13.1
    sizeBytes: 203198557
  - names:
    - registry.suse.com/suse/sles/15.7/virt-controller:1.6.3-150700.3.13.1
    sizeBytes: 201155368
  - names:
    - registry.suse.com/suse/sles/15.7/cdi-operator:1.62.0-150700.9.3.1
    sizeBytes: 199075883
  - names:
    - registry.suse.com/suse/sles/15.7/cdi-apiserver:1.62.0-150700.9.3.1
    sizeBytes: 190692258
  - names:
    - docker.io/rancher/harvester-cluster-repo:v1.7
    sizeBytes: 190290810
  - names:
    - registry.suse.com/suse/sles/15.7/cdi-uploadproxy:1.62.0-150700.9.3.1
    sizeBytes: 186396854
  - names:
    - registry.suse.com/suse/sles/15.7/cdi-controller:1.62.0-150700.9.3.1
    sizeBytes: 181657246
  - names:
    - docker.io/rancher/harvester-node-manager-webhook:v1.7.0
    sizeBytes: 181319813
  nodeInfo:
    architecture: amd64
    bootID: 1fb1d6b3-5771-4432-a59a-4ca2b2f7ee45
    containerRuntimeVersion: containerd://2.1.5-k3s1
    kernelVersion: 6.4.0-36-default
    kubeProxyVersion: ""
    kubeletVersion: v1.34.2+rke2r1
    machineID: 17b6fa03558170feeadfa60a6969a7c8
    operatingSystem: linux
    osImage: Harvester v1.7
    systemUUID: 7852851b-0094-4fb5-be77-37e48cf502fd
  runtimeHandlers:
  - features:
      recursiveReadOnlyMounts: true
      userNamespaces: true
    name: ""
  - features:
      recursiveReadOnlyMounts: true
      userNamespaces: true
    name: runc
  - features:
      recursiveReadOnlyMounts: false
      userNamespaces: false
    name: runhcs-wcow-process`

	nodeConditionTrue = `apiVersion: v1
kind: Node
metadata:
  annotations:
    alpha.kubernetes.io/provided-node-ip: 10.115.52.90
    cluster.x-k8s.io/annotations-from-machine: ""
    cluster.x-k8s.io/cluster-name: local
    cluster.x-k8s.io/cluster-namespace: fleet-local
    cluster.x-k8s.io/labels-from-machine: ""
    cluster.x-k8s.io/machine: custom-8b3d1bdf21ef
    csi.volume.kubernetes.io/nodeid: '{"driver.longhorn.io":"harvester-node-1"}'
    etcd.rke2.cattle.io/local-snapshots-timestamp: "2026-01-19T05:35:10Z"
    etcd.rke2.cattle.io/node-address: 10.115.52.90
    etcd.rke2.cattle.io/node-name: harvester-node-1-9d108e7d
    flannel.alpha.coreos.com/backend-data: '{"VNI":1,"VtepMAC":"0a:7d:b7:39:dc:d1"}'
    flannel.alpha.coreos.com/backend-type: vxlan
    flannel.alpha.coreos.com/kube-subnet-manager: "true"
    flannel.alpha.coreos.com/public-ip: 10.115.52.90
    harvesterhci.io/promote-status: complete
    kubevirt.io/heartbeat: "2026-01-19T05:35:16Z"
    kubevirt.io/ksm-handler-managed: "false"
    management.cattle.io/pod-limits: '{"cpu":"100m","memory":"128Mi"}'
    management.cattle.io/pod-requests: '{"cpu":"1360m","memory":"2240Mi","pods":"12"}'
    node.alpha.kubernetes.io/ttl: "0"
    node.harvesterhci.io/ntp-service: '{"ntpSyncStatus":"synced","currentNtpServers":"0.suse.pool.ntp.org
      1.suse.pool.ntp.org"}'
    rke2.io/encryption-config-hash: start-be0557c28851151a863e012edbe29a29048fb7b5bfd2e9e2a419925db3de3d7f
    rke2.io/hostname: harvester-node-1
    rke2.io/internal-ip: 10.115.52.90
    rke2.io/node-args: '["server","--disable","rke2-snapshot-controller","--disable","rke2-snapshot-controller-crd","--disable","rke2-snapshot-validation-webhook","--agent-token","********","--cni","multus,canal","--kube-controller-manager-arg","cert-dir=/var/lib/rancher/rke2/server/tls/kube-controller-manager","--kube-controller-manager-arg","secure-port=10257","--kube-controller-manager-extra-mount","/var/lib/rancher/rke2/server/tls/kube-controller-manager:/var/lib/rancher/rke2/server/tls/kube-controller-manager","--kube-scheduler-arg","cert-dir=/var/lib/rancher/rke2/server/tls/kube-scheduler","--kube-scheduler-arg","secure-port=10259","--kube-scheduler-extra-mount","/var/lib/rancher/rke2/server/tls/kube-scheduler:/var/lib/rancher/rke2/server/tls/kube-scheduler","--node-label","harvesterhci.io/managed=true","--node-label","rke.cattle.io/machine=d4669472-188d-42e6-86cc-e4b2ddf76c88","--node-name","harvester-node-1","--private-registry","/etc/rancher/rke2/registries.yaml","--server","https://10.115.52.89:9345","--token","********","--kubelet-arg","max-pods=200","--kubelet-arg","system-reserved=cpu=400m","--kubelet-arg","kube-reserved=cpu=600m","--cluster-cidr","10.52.0.0/16","--service-cidr","10.53.0.0/16","--cluster-dns","10.53.0.10","--tls-san","10.115.52.92","--audit-policy-file","/etc/rancher/rke2/config.yaml.d/92-harvester-kube-audit-policy.yaml","--nonroot-devices","true","--apiVersion","audit.k8s.io/v1","--kind","Policy","--omitStages","ResponseStarted","--omitStages","ResponseComplete","--rules","[{level
      Metadata} {verbs [create delete patch]} {omitStages [ResponseStarted ResponseComplete]}]"]'
    rke2.io/node-config-hash: B7K5XHTPBGV6N3CTCEFP74JAZV5MJJODHOD3LWXR4PFYEL6Q6RKA====
    rke2.io/node-env: '{"RKE2_DATA_DIR":"/var/lib/rancher/rke2"}'
    volumes.kubernetes.io/controller-managed-attach-detach: "true"
  creationTimestamp: "2026-01-16T02:52:48Z"
  finalizers:
  - wrangler.cattle.io/harvester-network-manager-node-controller
  - wrangler.cattle.io/node
  - wrangler.cattle.io/managed-etcd-controller
  - wrangler.cattle.io/maintain-node-controller
  - wrangler.cattle.io/node-remove-controller
  labels:
    beta.kubernetes.io/arch: amd64
    beta.kubernetes.io/instance-type: rke2
    beta.kubernetes.io/os: linux
    cpu-feature.node.kubevirt.io/abm: "true"
    cpu-feature.node.kubevirt.io/aes: "true"
    cpu-feature.node.kubevirt.io/amd-ssbd: "true"
    cpu-feature.node.kubevirt.io/amd-stibp: "true"
    cpu-feature.node.kubevirt.io/apic: "true"
    cpu-feature.node.kubevirt.io/arat: "true"
    cpu-feature.node.kubevirt.io/arch-capabilities: "true"
    cpu-feature.node.kubevirt.io/avx: "true"
    cpu-feature.node.kubevirt.io/avx2: "true"
    cpu-feature.node.kubevirt.io/bmi1: "true"
    cpu-feature.node.kubevirt.io/bmi2: "true"
    cpu-feature.node.kubevirt.io/clflush: "true"
    cpu-feature.node.kubevirt.io/cmov: "true"
    cpu-feature.node.kubevirt.io/cx8: "true"
    cpu-feature.node.kubevirt.io/cx16: "true"
    cpu-feature.node.kubevirt.io/de: "true"
    cpu-feature.node.kubevirt.io/erms: "true"
    cpu-feature.node.kubevirt.io/f16c: "true"
    cpu-feature.node.kubevirt.io/flush-l1d: "true"
    cpu-feature.node.kubevirt.io/fma: "true"
    cpu-feature.node.kubevirt.io/fpu: "true"
    cpu-feature.node.kubevirt.io/fsgsbase: "true"
    cpu-feature.node.kubevirt.io/fxsr: "true"
    cpu-feature.node.kubevirt.io/gds-no: "true"
    cpu-feature.node.kubevirt.io/hypervisor: "true"
    cpu-feature.node.kubevirt.io/ibpb: "true"
    cpu-feature.node.kubevirt.io/ibrs: "true"
    cpu-feature.node.kubevirt.io/invpcid: "true"
    cpu-feature.node.kubevirt.io/lahf_lm: "true"
    cpu-feature.node.kubevirt.io/lm: "true"
    cpu-feature.node.kubevirt.io/mca: "true"
    cpu-feature.node.kubevirt.io/mce: "true"
    cpu-feature.node.kubevirt.io/md-clear: "true"
    cpu-feature.node.kubevirt.io/mmx: "true"
    cpu-feature.node.kubevirt.io/movbe: "true"
    cpu-feature.node.kubevirt.io/msr: "true"
    cpu-feature.node.kubevirt.io/mtrr: "true"
    cpu-feature.node.kubevirt.io/nx: "true"
    cpu-feature.node.kubevirt.io/pae: "true"
    cpu-feature.node.kubevirt.io/pat: "true"
    cpu-feature.node.kubevirt.io/pcid: "true"
    cpu-feature.node.kubevirt.io/pclmuldq: "true"
    cpu-feature.node.kubevirt.io/pdcm: "true"
    cpu-feature.node.kubevirt.io/pdpe1gb: "true"
    cpu-feature.node.kubevirt.io/pge: "true"
    cpu-feature.node.kubevirt.io/pni: "true"
    cpu-feature.node.kubevirt.io/popcnt: "true"
    cpu-feature.node.kubevirt.io/pschange-mc-no: "true"
    cpu-feature.node.kubevirt.io/pse: "true"
    cpu-feature.node.kubevirt.io/pse36: "true"
    cpu-feature.node.kubevirt.io/rdrand: "true"
    cpu-feature.node.kubevirt.io/rdtscp: "true"
    cpu-feature.node.kubevirt.io/rfds-no: "true"
    cpu-feature.node.kubevirt.io/sep: "true"
    cpu-feature.node.kubevirt.io/skip-l1dfl-vmentry: "true"
    cpu-feature.node.kubevirt.io/smep: "true"
    cpu-feature.node.kubevirt.io/spec-ctrl: "true"
    cpu-feature.node.kubevirt.io/ss: "true"
    cpu-feature.node.kubevirt.io/ssbd: "true"
    cpu-feature.node.kubevirt.io/sse: "true"
    cpu-feature.node.kubevirt.io/sse2: "true"
    cpu-feature.node.kubevirt.io/sse4.1: "true"
    cpu-feature.node.kubevirt.io/sse4.2: "true"
    cpu-feature.node.kubevirt.io/ssse3: "true"
    cpu-feature.node.kubevirt.io/stibp: "true"
    cpu-feature.node.kubevirt.io/syscall: "true"
    cpu-feature.node.kubevirt.io/tsc: "true"
    cpu-feature.node.kubevirt.io/tsc-deadline: "true"
    cpu-feature.node.kubevirt.io/tsc_adjust: "true"
    cpu-feature.node.kubevirt.io/umip: "true"
    cpu-feature.node.kubevirt.io/vme: "true"
    cpu-feature.node.kubevirt.io/vmx: "true"
    cpu-feature.node.kubevirt.io/vmx-activity-hlt: "true"
    cpu-feature.node.kubevirt.io/vmx-activity-wait-sipi: "true"
    cpu-feature.node.kubevirt.io/vmx-apicv-register: "true"
    cpu-feature.node.kubevirt.io/vmx-apicv-vid: "true"
    cpu-feature.node.kubevirt.io/vmx-apicv-x2apic: "true"
    cpu-feature.node.kubevirt.io/vmx-apicv-xapic: "true"
    cpu-feature.node.kubevirt.io/vmx-cr3-load-noexit: "true"
    cpu-feature.node.kubevirt.io/vmx-cr3-store-noexit: "true"
    cpu-feature.node.kubevirt.io/vmx-cr8-load-exit: "true"
    cpu-feature.node.kubevirt.io/vmx-cr8-store-exit: "true"
    cpu-feature.node.kubevirt.io/vmx-desc-exit: "true"
    cpu-feature.node.kubevirt.io/vmx-entry-ia32e-mode: "true"
    cpu-feature.node.kubevirt.io/vmx-entry-load-efer: "true"
    cpu-feature.node.kubevirt.io/vmx-entry-load-pat: "true"
    cpu-feature.node.kubevirt.io/vmx-entry-load-perf-global-ctrl: "true"
    cpu-feature.node.kubevirt.io/vmx-entry-noload-debugctl: "true"
    cpu-feature.node.kubevirt.io/vmx-ept: "true"
    cpu-feature.node.kubevirt.io/vmx-ept-1gb: "true"
    cpu-feature.node.kubevirt.io/vmx-ept-2mb: "true"
    cpu-feature.node.kubevirt.io/vmx-ept-execonly: "true"
    cpu-feature.node.kubevirt.io/vmx-eptad: "true"
    cpu-feature.node.kubevirt.io/vmx-eptp-switching: "true"
    cpu-feature.node.kubevirt.io/vmx-exit-ack-intr: "true"
    cpu-feature.node.kubevirt.io/vmx-exit-load-efer: "true"
    cpu-feature.node.kubevirt.io/vmx-exit-load-pat: "true"
    cpu-feature.node.kubevirt.io/vmx-exit-load-perf-global-ctrl: "true"
    cpu-feature.node.kubevirt.io/vmx-exit-nosave-debugctl: "true"
    cpu-feature.node.kubevirt.io/vmx-exit-save-efer: "true"
    cpu-feature.node.kubevirt.io/vmx-exit-save-pat: "true"
    cpu-feature.node.kubevirt.io/vmx-exit-save-preemption-timer: "true"
    cpu-feature.node.kubevirt.io/vmx-flexpriority: "true"
    cpu-feature.node.kubevirt.io/vmx-hlt-exit: "true"
    cpu-feature.node.kubevirt.io/vmx-ins-outs: "true"
    cpu-feature.node.kubevirt.io/vmx-intr-exit: "true"
    cpu-feature.node.kubevirt.io/vmx-invept: "true"
    cpu-feature.node.kubevirt.io/vmx-invept-all-context: "true"
    cpu-feature.node.kubevirt.io/vmx-invept-single-context: "true"
    cpu-feature.node.kubevirt.io/vmx-invlpg-exit: "true"
    cpu-feature.node.kubevirt.io/vmx-invpcid-exit: "true"
    cpu-feature.node.kubevirt.io/vmx-invvpid: "true"
    cpu-feature.node.kubevirt.io/vmx-invvpid-all-context: "true"
    cpu-feature.node.kubevirt.io/vmx-invvpid-single-addr: "true"
    cpu-feature.node.kubevirt.io/vmx-invvpid-single-context-noglobals: "true"
    cpu-feature.node.kubevirt.io/vmx-io-bitmap: "true"
    cpu-feature.node.kubevirt.io/vmx-io-exit: "true"
    cpu-feature.node.kubevirt.io/vmx-monitor-exit: "true"
    cpu-feature.node.kubevirt.io/vmx-movdr-exit: "true"
    cpu-feature.node.kubevirt.io/vmx-msr-bitmap: "true"
    cpu-feature.node.kubevirt.io/vmx-mtf: "true"
    cpu-feature.node.kubevirt.io/vmx-mwait-exit: "true"
    cpu-feature.node.kubevirt.io/vmx-nmi-exit: "true"
    cpu-feature.node.kubevirt.io/vmx-page-walk-4: "true"
    cpu-feature.node.kubevirt.io/vmx-pause-exit: "true"
    cpu-feature.node.kubevirt.io/vmx-pml: "true"
    cpu-feature.node.kubevirt.io/vmx-posted-intr: "true"
    cpu-feature.node.kubevirt.io/vmx-preemption-timer: "true"
    cpu-feature.node.kubevirt.io/vmx-rdpmc-exit: "true"
    cpu-feature.node.kubevirt.io/vmx-rdrand-exit: "true"
    cpu-feature.node.kubevirt.io/vmx-rdtsc-exit: "true"
    cpu-feature.node.kubevirt.io/vmx-rdtscp-exit: "true"
    cpu-feature.node.kubevirt.io/vmx-secondary-ctls: "true"
    cpu-feature.node.kubevirt.io/vmx-shadow-vmcs: "true"
    cpu-feature.node.kubevirt.io/vmx-store-lma: "true"
    cpu-feature.node.kubevirt.io/vmx-true-ctls: "true"
    cpu-feature.node.kubevirt.io/vmx-tsc-offset: "true"
    cpu-feature.node.kubevirt.io/vmx-unrestricted-guest: "true"
    cpu-feature.node.kubevirt.io/vmx-vintr-pending: "true"
    cpu-feature.node.kubevirt.io/vmx-vmfunc: "true"
    cpu-feature.node.kubevirt.io/vmx-vmwrite-vmexit-fields: "true"
    cpu-feature.node.kubevirt.io/vmx-vnmi: "true"
    cpu-feature.node.kubevirt.io/vmx-vnmi-pending: "true"
    cpu-feature.node.kubevirt.io/vmx-vpid: "true"
    cpu-feature.node.kubevirt.io/vmx-wbinvd-exit: "true"
    cpu-feature.node.kubevirt.io/x2apic: "true"
    cpu-feature.node.kubevirt.io/xsave: "true"
    cpu-feature.node.kubevirt.io/xsaveopt: "true"
    cpu-model-migration.node.kubevirt.io/Haswell-noTSX: "true"
    cpu-model-migration.node.kubevirt.io/Haswell-noTSX-IBRS: "true"
    cpu-model-migration.node.kubevirt.io/Haswell-v2: "true"
    cpu-model-migration.node.kubevirt.io/Haswell-v4: "true"
    cpu-model-migration.node.kubevirt.io/IvyBridge: "true"
    cpu-model-migration.node.kubevirt.io/IvyBridge-IBRS: "true"
    cpu-model-migration.node.kubevirt.io/IvyBridge-v1: "true"
    cpu-model-migration.node.kubevirt.io/IvyBridge-v2: "true"
    cpu-model-migration.node.kubevirt.io/Nehalem: "true"
    cpu-model-migration.node.kubevirt.io/Nehalem-IBRS: "true"
    cpu-model-migration.node.kubevirt.io/Nehalem-v1: "true"
    cpu-model-migration.node.kubevirt.io/Nehalem-v2: "true"
    cpu-model-migration.node.kubevirt.io/Penryn: "true"
    cpu-model-migration.node.kubevirt.io/Penryn-v1: "true"
    cpu-model-migration.node.kubevirt.io/SandyBridge: "true"
    cpu-model-migration.node.kubevirt.io/SandyBridge-IBRS: "true"
    cpu-model-migration.node.kubevirt.io/SandyBridge-v1: "true"
    cpu-model-migration.node.kubevirt.io/SandyBridge-v2: "true"
    cpu-model-migration.node.kubevirt.io/Westmere: "true"
    cpu-model-migration.node.kubevirt.io/Westmere-IBRS: "true"
    cpu-model-migration.node.kubevirt.io/Westmere-v1: "true"
    cpu-model-migration.node.kubevirt.io/Westmere-v2: "true"
    cpu-model.node.kubevirt.io/Haswell-noTSX: "true"
    cpu-model.node.kubevirt.io/Haswell-noTSX-IBRS: "true"
    cpu-model.node.kubevirt.io/Haswell-v2: "true"
    cpu-model.node.kubevirt.io/Haswell-v4: "true"
    cpu-model.node.kubevirt.io/IvyBridge: "true"
    cpu-model.node.kubevirt.io/IvyBridge-IBRS: "true"
    cpu-model.node.kubevirt.io/IvyBridge-v1: "true"
    cpu-model.node.kubevirt.io/IvyBridge-v2: "true"
    cpu-model.node.kubevirt.io/Nehalem: "true"
    cpu-model.node.kubevirt.io/Nehalem-IBRS: "true"
    cpu-model.node.kubevirt.io/Nehalem-v1: "true"
    cpu-model.node.kubevirt.io/Nehalem-v2: "true"
    cpu-model.node.kubevirt.io/Penryn: "true"
    cpu-model.node.kubevirt.io/Penryn-v1: "true"
    cpu-model.node.kubevirt.io/SandyBridge: "true"
    cpu-model.node.kubevirt.io/SandyBridge-IBRS: "true"
    cpu-model.node.kubevirt.io/SandyBridge-v1: "true"
    cpu-model.node.kubevirt.io/SandyBridge-v2: "true"
    cpu-model.node.kubevirt.io/Westmere: "true"
    cpu-model.node.kubevirt.io/Westmere-IBRS: "true"
    cpu-model.node.kubevirt.io/Westmere-v1: "true"
    cpu-model.node.kubevirt.io/Westmere-v2: "true"
    cpu-vendor.node.kubevirt.io/Intel: "true"
    cpumanager: "false"
    harvesterhci.io/managed: "true"
    host-model-cpu.node.kubevirt.io/Haswell-noTSX-IBRS: "true"
    host-model-required-features.node.kubevirt.io/abm: "true"
    host-model-required-features.node.kubevirt.io/amd-ssbd: "true"
    host-model-required-features.node.kubevirt.io/amd-stibp: "true"
    host-model-required-features.node.kubevirt.io/arat: "true"
    host-model-required-features.node.kubevirt.io/arch-capabilities: "true"
    host-model-required-features.node.kubevirt.io/f16c: "true"
    host-model-required-features.node.kubevirt.io/flush-l1d: "true"
    host-model-required-features.node.kubevirt.io/gds-no: "true"
    host-model-required-features.node.kubevirt.io/hypervisor: "true"
    host-model-required-features.node.kubevirt.io/ibpb: "true"
    host-model-required-features.node.kubevirt.io/ibrs: "true"
    host-model-required-features.node.kubevirt.io/md-clear: "true"
    host-model-required-features.node.kubevirt.io/pdcm: "true"
    host-model-required-features.node.kubevirt.io/pdpe1gb: "true"
    host-model-required-features.node.kubevirt.io/pschange-mc-no: "true"
    host-model-required-features.node.kubevirt.io/rdrand: "true"
    host-model-required-features.node.kubevirt.io/rfds-no: "true"
    host-model-required-features.node.kubevirt.io/skip-l1dfl-vmentry: "true"
    host-model-required-features.node.kubevirt.io/ss: "true"
    host-model-required-features.node.kubevirt.io/ssbd: "true"
    host-model-required-features.node.kubevirt.io/stibp: "true"
    host-model-required-features.node.kubevirt.io/tsc_adjust: "true"
    host-model-required-features.node.kubevirt.io/umip: "true"
    host-model-required-features.node.kubevirt.io/vme: "true"
    host-model-required-features.node.kubevirt.io/vmx: "true"
    host-model-required-features.node.kubevirt.io/vmx-activity-hlt: "true"
    host-model-required-features.node.kubevirt.io/vmx-activity-wait-sipi: "true"
    host-model-required-features.node.kubevirt.io/vmx-apicv-register: "true"
    host-model-required-features.node.kubevirt.io/vmx-apicv-vid: "true"
    host-model-required-features.node.kubevirt.io/vmx-apicv-x2apic: "true"
    host-model-required-features.node.kubevirt.io/vmx-apicv-xapic: "true"
    host-model-required-features.node.kubevirt.io/vmx-cr3-load-noexit: "true"
    host-model-required-features.node.kubevirt.io/vmx-cr3-store-noexit: "true"
    host-model-required-features.node.kubevirt.io/vmx-cr8-load-exit: "true"
    host-model-required-features.node.kubevirt.io/vmx-cr8-store-exit: "true"
    host-model-required-features.node.kubevirt.io/vmx-desc-exit: "true"
    host-model-required-features.node.kubevirt.io/vmx-entry-ia32e-mode: "true"
    host-model-required-features.node.kubevirt.io/vmx-entry-load-efer: "true"
    host-model-required-features.node.kubevirt.io/vmx-entry-load-pat: "true"
    host-model-required-features.node.kubevirt.io/vmx-entry-load-perf-global-ctrl: "true"
    host-model-required-features.node.kubevirt.io/vmx-entry-noload-debugctl: "true"
    host-model-required-features.node.kubevirt.io/vmx-ept: "true"
    host-model-required-features.node.kubevirt.io/vmx-ept-1gb: "true"
    host-model-required-features.node.kubevirt.io/vmx-ept-2mb: "true"
    host-model-required-features.node.kubevirt.io/vmx-ept-execonly: "true"
    host-model-required-features.node.kubevirt.io/vmx-eptad: "true"
    host-model-required-features.node.kubevirt.io/vmx-eptp-switching: "true"
    host-model-required-features.node.kubevirt.io/vmx-exit-ack-intr: "true"
    host-model-required-features.node.kubevirt.io/vmx-exit-load-efer: "true"
    host-model-required-features.node.kubevirt.io/vmx-exit-load-pat: "true"
    host-model-required-features.node.kubevirt.io/vmx-exit-load-perf-global-ctrl: "true"
    host-model-required-features.node.kubevirt.io/vmx-exit-nosave-debugctl: "true"
    host-model-required-features.node.kubevirt.io/vmx-exit-save-efer: "true"
    host-model-required-features.node.kubevirt.io/vmx-exit-save-pat: "true"
    host-model-required-features.node.kubevirt.io/vmx-exit-save-preemption-timer: "true"
    host-model-required-features.node.kubevirt.io/vmx-flexpriority: "true"
    host-model-required-features.node.kubevirt.io/vmx-hlt-exit: "true"
    host-model-required-features.node.kubevirt.io/vmx-ins-outs: "true"
    host-model-required-features.node.kubevirt.io/vmx-intr-exit: "true"
    host-model-required-features.node.kubevirt.io/vmx-invept: "true"
    host-model-required-features.node.kubevirt.io/vmx-invept-all-context: "true"
    host-model-required-features.node.kubevirt.io/vmx-invept-single-context: "true"
    host-model-required-features.node.kubevirt.io/vmx-invlpg-exit: "true"
    host-model-required-features.node.kubevirt.io/vmx-invpcid-exit: "true"
    host-model-required-features.node.kubevirt.io/vmx-invvpid: "true"
    host-model-required-features.node.kubevirt.io/vmx-invvpid-all-context: "true"
    host-model-required-features.node.kubevirt.io/vmx-invvpid-single-addr: "true"
    host-model-required-features.node.kubevirt.io/vmx-invvpid-single-context-noglobals: "true"
    host-model-required-features.node.kubevirt.io/vmx-io-bitmap: "true"
    host-model-required-features.node.kubevirt.io/vmx-io-exit: "true"
    host-model-required-features.node.kubevirt.io/vmx-monitor-exit: "true"
    host-model-required-features.node.kubevirt.io/vmx-movdr-exit: "true"
    host-model-required-features.node.kubevirt.io/vmx-msr-bitmap: "true"
    host-model-required-features.node.kubevirt.io/vmx-mtf: "true"
    host-model-required-features.node.kubevirt.io/vmx-mwait-exit: "true"
    host-model-required-features.node.kubevirt.io/vmx-nmi-exit: "true"
    host-model-required-features.node.kubevirt.io/vmx-page-walk-4: "true"
    host-model-required-features.node.kubevirt.io/vmx-pause-exit: "true"
    host-model-required-features.node.kubevirt.io/vmx-pml: "true"
    host-model-required-features.node.kubevirt.io/vmx-posted-intr: "true"
    host-model-required-features.node.kubevirt.io/vmx-preemption-timer: "true"
    host-model-required-features.node.kubevirt.io/vmx-rdpmc-exit: "true"
    host-model-required-features.node.kubevirt.io/vmx-rdrand-exit: "true"
    host-model-required-features.node.kubevirt.io/vmx-rdtsc-exit: "true"
    host-model-required-features.node.kubevirt.io/vmx-rdtscp-exit: "true"
    host-model-required-features.node.kubevirt.io/vmx-secondary-ctls: "true"
    host-model-required-features.node.kubevirt.io/vmx-shadow-vmcs: "true"
    host-model-required-features.node.kubevirt.io/vmx-store-lma: "true"
    host-model-required-features.node.kubevirt.io/vmx-true-ctls: "true"
    host-model-required-features.node.kubevirt.io/vmx-tsc-offset: "true"
    host-model-required-features.node.kubevirt.io/vmx-unrestricted-guest: "true"
    host-model-required-features.node.kubevirt.io/vmx-vintr-pending: "true"
    host-model-required-features.node.kubevirt.io/vmx-vmfunc: "true"
    host-model-required-features.node.kubevirt.io/vmx-vmwrite-vmexit-fields: "true"
    host-model-required-features.node.kubevirt.io/vmx-vnmi: "true"
    host-model-required-features.node.kubevirt.io/vmx-vnmi-pending: "true"
    host-model-required-features.node.kubevirt.io/vmx-vpid: "true"
    host-model-required-features.node.kubevirt.io/vmx-wbinvd-exit: "true"
    host-model-required-features.node.kubevirt.io/xsaveopt: "true"
    hyperv.node.kubevirt.io/base: "true"
    hyperv.node.kubevirt.io/frequencies: "true"
    hyperv.node.kubevirt.io/ipi: "true"
    hyperv.node.kubevirt.io/reenlightenment: "true"
    hyperv.node.kubevirt.io/reset: "true"
    hyperv.node.kubevirt.io/runtime: "true"
    hyperv.node.kubevirt.io/synic: "true"
    hyperv.node.kubevirt.io/synic2: "true"
    hyperv.node.kubevirt.io/synictimer: "true"
    hyperv.node.kubevirt.io/time: "true"
    hyperv.node.kubevirt.io/tlbflush: "true"
    hyperv.node.kubevirt.io/vpindex: "true"
    kubernetes.io/arch: amd64
    kubernetes.io/hostname: harvester-node-1
    kubernetes.io/os: linux
    kubevirt.io/ksm-enabled: "false"
    kubevirt.io/schedulable: "false"
    machine-type.node.kubevirt.io/isapc: "true"
    machine-type.node.kubevirt.io/microvm: "true"
    machine-type.node.kubevirt.io/nitro-enclave: "true"
    machine-type.node.kubevirt.io/pc: "true"
    machine-type.node.kubevirt.io/pc-i440fx-2.4: "true"
    machine-type.node.kubevirt.io/pc-i440fx-2.5: "true"
    machine-type.node.kubevirt.io/pc-i440fx-2.6: "true"
    machine-type.node.kubevirt.io/pc-i440fx-2.7: "true"
    machine-type.node.kubevirt.io/pc-i440fx-2.8: "true"
    machine-type.node.kubevirt.io/pc-i440fx-2.9: "true"
    machine-type.node.kubevirt.io/pc-i440fx-2.10: "true"
    machine-type.node.kubevirt.io/pc-i440fx-2.11: "true"
    machine-type.node.kubevirt.io/pc-i440fx-2.12: "true"
    machine-type.node.kubevirt.io/pc-i440fx-3.0: "true"
    machine-type.node.kubevirt.io/pc-i440fx-3.1: "true"
    machine-type.node.kubevirt.io/pc-i440fx-4.0: "true"
    machine-type.node.kubevirt.io/pc-i440fx-4.1: "true"
    machine-type.node.kubevirt.io/pc-i440fx-4.2: "true"
    machine-type.node.kubevirt.io/pc-i440fx-5.0: "true"
    machine-type.node.kubevirt.io/pc-i440fx-5.1: "true"
    machine-type.node.kubevirt.io/pc-i440fx-5.2: "true"
    machine-type.node.kubevirt.io/pc-i440fx-6.0: "true"
    machine-type.node.kubevirt.io/pc-i440fx-6.1: "true"
    machine-type.node.kubevirt.io/pc-i440fx-6.2: "true"
    machine-type.node.kubevirt.io/pc-i440fx-7.0: "true"
    machine-type.node.kubevirt.io/pc-i440fx-7.1: "true"
    machine-type.node.kubevirt.io/pc-i440fx-7.2: "true"
    machine-type.node.kubevirt.io/pc-i440fx-8.0: "true"
    machine-type.node.kubevirt.io/pc-i440fx-8.1: "true"
    machine-type.node.kubevirt.io/pc-i440fx-8.2: "true"
    machine-type.node.kubevirt.io/pc-i440fx-9.0: "true"
    machine-type.node.kubevirt.io/pc-i440fx-9.1: "true"
    machine-type.node.kubevirt.io/pc-i440fx-9.2: "true"
    machine-type.node.kubevirt.io/pc-q35-2.4: "true"
    machine-type.node.kubevirt.io/pc-q35-2.5: "true"
    machine-type.node.kubevirt.io/pc-q35-2.6: "true"
    machine-type.node.kubevirt.io/pc-q35-2.7: "true"
    machine-type.node.kubevirt.io/pc-q35-2.8: "true"
    machine-type.node.kubevirt.io/pc-q35-2.9: "true"
    machine-type.node.kubevirt.io/pc-q35-2.10: "true"
    machine-type.node.kubevirt.io/pc-q35-2.11: "true"
    machine-type.node.kubevirt.io/pc-q35-2.12: "true"
    machine-type.node.kubevirt.io/pc-q35-3.0: "true"
    machine-type.node.kubevirt.io/pc-q35-3.1: "true"
    machine-type.node.kubevirt.io/pc-q35-4.0: "true"
    machine-type.node.kubevirt.io/pc-q35-4.0.1: "true"
    machine-type.node.kubevirt.io/pc-q35-4.1: "true"
    machine-type.node.kubevirt.io/pc-q35-4.2: "true"
    machine-type.node.kubevirt.io/pc-q35-5.0: "true"
    machine-type.node.kubevirt.io/pc-q35-5.1: "true"
    machine-type.node.kubevirt.io/pc-q35-5.2: "true"
    machine-type.node.kubevirt.io/pc-q35-6.0: "true"
    machine-type.node.kubevirt.io/pc-q35-6.1: "true"
    machine-type.node.kubevirt.io/pc-q35-6.2: "true"
    machine-type.node.kubevirt.io/pc-q35-7.0: "true"
    machine-type.node.kubevirt.io/pc-q35-7.1: "true"
    machine-type.node.kubevirt.io/pc-q35-7.2: "true"
    machine-type.node.kubevirt.io/pc-q35-8.0: "true"
    machine-type.node.kubevirt.io/pc-q35-8.1: "true"
    machine-type.node.kubevirt.io/pc-q35-8.2: "true"
    machine-type.node.kubevirt.io/pc-q35-9.0: "true"
    machine-type.node.kubevirt.io/pc-q35-9.1: "true"
    machine-type.node.kubevirt.io/pc-q35-9.2: "true"
    machine-type.node.kubevirt.io/q35: "true"
    machine-type.node.kubevirt.io/xenfv: "true"
    machine-type.node.kubevirt.io/xenfv-3.1: "true"
    machine-type.node.kubevirt.io/xenfv-4.2: "true"
    machine-type.node.kubevirt.io/xenpv: "true"
    machine-type.node.kubevirt.io/xenpvh: "true"
    network.harvesterhci.io/cn: "true"
    network.harvesterhci.io/mgmt: "true"
    network.harvesterhci.io/vlanconfig: nc
    node-role.kubernetes.io/control-plane: "true"
    node-role.kubernetes.io/etcd: "true"
    node.kubernetes.io/instance-type: rke2
    plan.upgrade.cattle.io/sync-additional-ca: 2c27af4f7e139d7c15346edc0adb200edade07eef796ef2c41ef923b
    plan.upgrade.cattle.io/system-agent-upgrader: cab0e3bd454d91beec8ee44425add5c2cd494696a84c38239deb82f1
    rke.cattle.io/machine: d4669472-188d-42e6-86cc-e4b2ddf76c88
  name: harvester-node-1
  resourceVersion: "5610701"
  uid: 9221811e-1f0e-4958-9aba-468444971fcb
spec:
  podCIDR: 10.52.1.0/24
  podCIDRs:
  - 10.52.1.0/24
  providerID: rke2://harvester-node-1
  taints:
  - effect: NoSchedule
    key: node.kubernetes.io/unreachable
    timeAdded: "2026-01-19T05:36:00Z"
  - effect: NoExecute
    key: node.kubernetes.io/unreachable
    timeAdded: "2026-01-19T05:36:00Z"
  - effect: NoSchedule
    key: kubevirt.io/drain
  - effect: NoExecute
    key: node.kubernetes.io/out-of-service
status:
  addresses:
  - address: 10.115.52.90
    type: InternalIP
  - address: harvester-node-1
    type: Hostname
  allocatable:
    cpu: "11"
    devices.kubevirt.io/kvm: 1k
    devices.kubevirt.io/tun: 1k
    devices.kubevirt.io/vhost-net: 1k
    ephemeral-storage: "276921388020"
    hugepages-1Gi: "0"
    hugepages-2Mi: "0"
    memory: 22392912Ki
    pods: "200"
  capacity:
    cpu: "12"
    devices.kubevirt.io/kvm: 1k
    devices.kubevirt.io/tun: 1k
    devices.kubevirt.io/vhost-net: 1k
    ephemeral-storage: 284664256Ki
    hugepages-1Gi: "0"
    hugepages-2Mi: "0"
    memory: 22392912Ki
    pods: "200"
  conditions:
  - lastHeartbeatTime: "2026-01-20T22:55:24Z"
    lastTransitionTime: "2026-01-16T02:57:23Z"
    message: Node is a voting member of the etcd cluster
    reason: MemberNotLearner
    status: "True"
    type: EtcdIsVoter
  - lastHeartbeatTime: "2026-01-16T02:53:47Z"
    lastTransitionTime: "2026-01-16T02:53:47Z"
    message: Flannel is running on this node
    reason: FlannelIsUp
    status: "False"
    type: NetworkUnavailable
  - lastHeartbeatTime: "2026-01-19T05:31:34Z"
    lastTransitionTime: "2026-01-19T05:36:00Z"
    message: Kubelet stopped posting node status.
    reason: NodeStatusUnknown
    status: Unknown
    type: MemoryPressure
  - lastHeartbeatTime: "2026-01-19T05:31:34Z"
    lastTransitionTime: "2026-01-19T05:36:00Z"
    message: Kubelet stopped posting node status.
    reason: NodeStatusUnknown
    status: Unknown
    type: DiskPressure
  - lastHeartbeatTime: "2026-01-19T05:31:34Z"
    lastTransitionTime: "2026-01-19T05:36:00Z"
    message: Kubelet stopped posting node status.
    reason: NodeStatusUnknown
    status: Unknown
    type: PIDPressure
  - lastHeartbeatTime: "2026-01-19T05:31:34Z"
    lastTransitionTime: "2026-01-19T05:36:00Z"
    message: Kubelet stopped posting node status.
    reason: NodeStatusUnknown
    status: Unknown
    type: Ready
  - lastHeartbeatTime: "2026-01-19T05:39:24Z"
    lastTransitionTime: "2026-01-19T05:36:19Z"
    message: Node is draining due to kubelet/node not ready.
    reason: HarvesterNodeIsDraining
    status: "True"
    type: Drained
  daemonEndpoints:
    kubeletEndpoint:
      Port: 10250
  features:
    supplementalGroupsPolicy: true
  images:
  - names:
    - docker.io/rancher/rancher:v2.13.0
    sizeBytes: 1780569233
  - names:
    - docker.io/longhornio/longhorn-instance-manager:v1.10.1
    sizeBytes: 1358647745
  - names:
    - docker.io/rancher/rancher-agent:v2.13.0
    sizeBytes: 840070356
  - names:
    - docker.io/kubeovn/kube-ovn:v1.14.10
    sizeBytes: 766595147
  - names:
    - registry.suse.com/suse/sles/15.7/libguestfs-tools:1.6.3-150700.3.13.1
    sizeBytes: 719820434
  - names:
    - docker.io/rancher/nginx-ingress-controller:v1.13.4-hardened1
    sizeBytes: 707490001
  - names:
    - docker.io/rancher/hardened-calico:v3.30.3-build20251015
    sizeBytes: 685524019
  - names:
    - docker.io/rancher/hardened-kubernetes:v1.34.2-rke2r1-build20251112
    sizeBytes: 640304363
  - names:
    - docker.io/rancher/mirrored-grafana-grafana:11.5.5
    sizeBytes: 595775533
  - names:
    - docker.io/rancher/harvester-upgrade:f601d3a5
    - docker.io/rancher/harvester-upgrade:v1.7-f601d3a5-head
    - docker.io/rancher/harvester-upgrade:v1.7-head
    sizeBytes: 539380404
  - names:
    - registry.suse.com/suse/sles/15.7/virt-launcher:1.6.3-150700.3.13.1
    sizeBytes: 536303999
  - names:
    - docker.io/longhornio/longhorn-engine:v1.10.1
    sizeBytes: 401541994
  - names:
    - docker.io/longhornio/backing-image-manager:v1.10.1
    sizeBytes: 396337321
  - names:
    - docker.io/rancher/mirrored-kube-logging-fluentd:v1.16-4.10-full
    sizeBytes: 388373272
  - names:
    - docker.io/rancher/shell:v0.6.0
    sizeBytes: 361840174
  - names:
    - docker.io/rancher/shell:v0.5.0
    sizeBytes: 353043502
  - names:
    - registry.suse.com/suse/sles/15.7/cdi-importer:1.62.0-150700.9.3.1
    sizeBytes: 344543711
  - names:
    - docker.io/longhornio/longhorn-manager:v1.10.1-hotfix-2
    sizeBytes: 340198509
  - names:
    - docker.io/rancher/harvester:v1.7-head
    sizeBytes: 338368313
  - names:
    - docker.io/longhornio/longhorn-manager:v1.10.1
    sizeBytes: 330481257
  - names:
    - docker.io/rancher/fleet:v0.14.0
    sizeBytes: 319225891
  - names:
    - docker.io/rancher/rke2-runtime:v1.34.2-rke2r1
    sizeBytes: 306299220
  - names:
    - docker.io/rancher/prom-prometheus:v3.2.1
    sizeBytes: 296367903
  - names:
    - docker.io/rancher/harvester-vm-import-controller:v1.7.0
    sizeBytes: 293606461
  - names:
    - docker.io/rancher/harvester-pcidevices:v1.7.0
    sizeBytes: 266649560
  - names:
    - docker.io/longhornio/longhorn-cli:v1.10.1
    sizeBytes: 255924943
  - names:
    - registry.suse.com/suse/sles/15.7/virt-handler:1.6.3-150700.3.13.1
    sizeBytes: 254717336
  - names:
    - docker.io/rancher/harvester-webhook:v1.7-head
    sizeBytes: 251790207
  - names:
    - docker.io/rancher/kuberlr-kubectl:v5.0.0
    sizeBytes: 251571844
  - names:
    - docker.io/rancher/support-bundle-kit:v0.0.74
    sizeBytes: 251150429
  - names:
    - docker.io/longhornio/support-bundle-kit:v0.0.71
    sizeBytes: 251072091
  - names:
    - docker.io/longhornio/longhorn-share-manager:v1.10.1
    sizeBytes: 241758234
  - names:
    - docker.io/rancher/harvester-seeder:v1.7.0
    sizeBytes: 229291817
  - names:
    - docker.io/rancher/system-agent:v0.3.14-suc
    sizeBytes: 218366310
  - names:
    - docker.io/longhornio/longhorn-ui:v1.10.1
    sizeBytes: 215792836
  - names:
    - docker.io/rancher/harvester-networkfs-manager:v1.7.0
    sizeBytes: 213212315
  - names:
    - docker.io/rancher/harvester-network-controller:v1.7.0
    sizeBytes: 211940539
  - names:
    - docker.io/rancher/harvester-kubeovn-operator:v1.14.10-dev.1
    sizeBytes: 211835920
  - names:
    - registry.suse.com/suse/sles/15.7/cdi-uploadserver:1.62.0-150700.9.3.1
    sizeBytes: 207361342
  - names:
    - docker.io/rancher/harvester-node-disk-manager:v1.7.0
    sizeBytes: 206875815
  - names:
    - registry.suse.com/suse/sles/15.7/virt-operator:1.6.3-150700.3.13.1
    sizeBytes: 205596893
  - names:
    - ghcr.io/k8snetworkplumbingwg/whereabouts:v0.9.2
    sizeBytes: 204231357
  - names:
    - registry.suse.com/suse/sles/15.7/virt-api:1.6.3-150700.3.13.1
    sizeBytes: 203198557
  - names:
    - registry.suse.com/suse/sles/15.7/virt-controller:1.6.3-150700.3.13.1
    sizeBytes: 201155368
  - names:
    - registry.suse.com/suse/sles/15.7/cdi-operator:1.62.0-150700.9.3.1
    sizeBytes: 199075883
  - names:
    - registry.suse.com/suse/sles/15.7/cdi-apiserver:1.62.0-150700.9.3.1
    sizeBytes: 190692258
  - names:
    - docker.io/rancher/harvester-cluster-repo:v1.7
    sizeBytes: 190290810
  - names:
    - registry.suse.com/suse/sles/15.7/cdi-uploadproxy:1.62.0-150700.9.3.1
    sizeBytes: 186396854
  - names:
    - registry.suse.com/suse/sles/15.7/cdi-controller:1.62.0-150700.9.3.1
    sizeBytes: 181657246
  - names:
    - docker.io/rancher/harvester-node-manager-webhook:v1.7.0
    sizeBytes: 181319813
  nodeInfo:
    architecture: amd64
    bootID: 1fb1d6b3-5771-4432-a59a-4ca2b2f7ee45
    containerRuntimeVersion: containerd://2.1.5-k3s1
    kernelVersion: 6.4.0-36-default
    kubeProxyVersion: ""
    kubeletVersion: v1.34.2+rke2r1
    machineID: 17b6fa03558170feeadfa60a6969a7c8
    operatingSystem: linux
    osImage: Harvester v1.7
    systemUUID: 7852851b-0094-4fb5-be77-37e48cf502fd
  runtimeHandlers:
  - features:
      recursiveReadOnlyMounts: true
      userNamespaces: true
    name: ""
  - features:
      recursiveReadOnlyMounts: true
      userNamespaces: true
    name: runc
  - features:
      recursiveReadOnlyMounts: false
      userNamespaces: false
    name: runhcs-wcow-process`

	nodeWithNoCondition = `apiVersion: v1
kind: Node
metadata:
  annotations:
    alpha.kubernetes.io/provided-node-ip: 10.115.52.90
    cluster.x-k8s.io/annotations-from-machine: ""
    cluster.x-k8s.io/cluster-name: local
    cluster.x-k8s.io/cluster-namespace: fleet-local
    cluster.x-k8s.io/labels-from-machine: ""
    cluster.x-k8s.io/machine: custom-8b3d1bdf21ef
    csi.volume.kubernetes.io/nodeid: '{"driver.longhorn.io":"harvester-node-1"}'
    etcd.rke2.cattle.io/local-snapshots-timestamp: "2026-01-19T05:35:10Z"
    etcd.rke2.cattle.io/node-address: 10.115.52.90
    etcd.rke2.cattle.io/node-name: harvester-node-1-9d108e7d
    flannel.alpha.coreos.com/backend-data: '{"VNI":1,"VtepMAC":"0a:7d:b7:39:dc:d1"}'
    flannel.alpha.coreos.com/backend-type: vxlan
    flannel.alpha.coreos.com/kube-subnet-manager: "true"
    flannel.alpha.coreos.com/public-ip: 10.115.52.90
    harvesterhci.io/promote-status: complete
    kubevirt.io/heartbeat: "2026-01-19T05:35:16Z"
    kubevirt.io/ksm-handler-managed: "false"
    management.cattle.io/pod-limits: '{"cpu":"100m","memory":"128Mi"}'
    management.cattle.io/pod-requests: '{"cpu":"1360m","memory":"2240Mi","pods":"12"}'
    node.alpha.kubernetes.io/ttl: "0"
    node.harvesterhci.io/ntp-service: '{"ntpSyncStatus":"synced","currentNtpServers":"0.suse.pool.ntp.org
      1.suse.pool.ntp.org"}'
    rke2.io/encryption-config-hash: start-be0557c28851151a863e012edbe29a29048fb7b5bfd2e9e2a419925db3de3d7f
    rke2.io/hostname: harvester-node-1
    rke2.io/internal-ip: 10.115.52.90
    rke2.io/node-args: '["server","--disable","rke2-snapshot-controller","--disable","rke2-snapshot-controller-crd","--disable","rke2-snapshot-validation-webhook","--agent-token","********","--cni","multus,canal","--kube-controller-manager-arg","cert-dir=/var/lib/rancher/rke2/server/tls/kube-controller-manager","--kube-controller-manager-arg","secure-port=10257","--kube-controller-manager-extra-mount","/var/lib/rancher/rke2/server/tls/kube-controller-manager:/var/lib/rancher/rke2/server/tls/kube-controller-manager","--kube-scheduler-arg","cert-dir=/var/lib/rancher/rke2/server/tls/kube-scheduler","--kube-scheduler-arg","secure-port=10259","--kube-scheduler-extra-mount","/var/lib/rancher/rke2/server/tls/kube-scheduler:/var/lib/rancher/rke2/server/tls/kube-scheduler","--node-label","harvesterhci.io/managed=true","--node-label","rke.cattle.io/machine=d4669472-188d-42e6-86cc-e4b2ddf76c88","--node-name","harvester-node-1","--private-registry","/etc/rancher/rke2/registries.yaml","--server","https://10.115.52.89:9345","--token","********","--kubelet-arg","max-pods=200","--kubelet-arg","system-reserved=cpu=400m","--kubelet-arg","kube-reserved=cpu=600m","--cluster-cidr","10.52.0.0/16","--service-cidr","10.53.0.0/16","--cluster-dns","10.53.0.10","--tls-san","10.115.52.92","--audit-policy-file","/etc/rancher/rke2/config.yaml.d/92-harvester-kube-audit-policy.yaml","--nonroot-devices","true","--apiVersion","audit.k8s.io/v1","--kind","Policy","--omitStages","ResponseStarted","--omitStages","ResponseComplete","--rules","[{level
      Metadata} {verbs [create delete patch]} {omitStages [ResponseStarted ResponseComplete]}]"]'
    rke2.io/node-config-hash: B7K5XHTPBGV6N3CTCEFP74JAZV5MJJODHOD3LWXR4PFYEL6Q6RKA====
    rke2.io/node-env: '{"RKE2_DATA_DIR":"/var/lib/rancher/rke2"}'
    volumes.kubernetes.io/controller-managed-attach-detach: "true"
  creationTimestamp: "2026-01-16T02:52:48Z"
  finalizers:
  - wrangler.cattle.io/harvester-network-manager-node-controller
  - wrangler.cattle.io/node
  - wrangler.cattle.io/managed-etcd-controller
  - wrangler.cattle.io/maintain-node-controller
  - wrangler.cattle.io/node-remove-controller
  labels:
    beta.kubernetes.io/arch: amd64
    beta.kubernetes.io/instance-type: rke2
    beta.kubernetes.io/os: linux
    cpu-feature.node.kubevirt.io/abm: "true"
    cpu-feature.node.kubevirt.io/aes: "true"
    cpu-feature.node.kubevirt.io/amd-ssbd: "true"
    cpu-feature.node.kubevirt.io/amd-stibp: "true"
    cpu-feature.node.kubevirt.io/apic: "true"
    cpu-feature.node.kubevirt.io/arat: "true"
    cpu-feature.node.kubevirt.io/arch-capabilities: "true"
    cpu-feature.node.kubevirt.io/avx: "true"
    cpu-feature.node.kubevirt.io/avx2: "true"
    cpu-feature.node.kubevirt.io/bmi1: "true"
    cpu-feature.node.kubevirt.io/bmi2: "true"
    cpu-feature.node.kubevirt.io/clflush: "true"
    cpu-feature.node.kubevirt.io/cmov: "true"
    cpu-feature.node.kubevirt.io/cx8: "true"
    cpu-feature.node.kubevirt.io/cx16: "true"
    cpu-feature.node.kubevirt.io/de: "true"
    cpu-feature.node.kubevirt.io/erms: "true"
    cpu-feature.node.kubevirt.io/f16c: "true"
    cpu-feature.node.kubevirt.io/flush-l1d: "true"
    cpu-feature.node.kubevirt.io/fma: "true"
    cpu-feature.node.kubevirt.io/fpu: "true"
    cpu-feature.node.kubevirt.io/fsgsbase: "true"
    cpu-feature.node.kubevirt.io/fxsr: "true"
    cpu-feature.node.kubevirt.io/gds-no: "true"
    cpu-feature.node.kubevirt.io/hypervisor: "true"
    cpu-feature.node.kubevirt.io/ibpb: "true"
    cpu-feature.node.kubevirt.io/ibrs: "true"
    cpu-feature.node.kubevirt.io/invpcid: "true"
    cpu-feature.node.kubevirt.io/lahf_lm: "true"
    cpu-feature.node.kubevirt.io/lm: "true"
    cpu-feature.node.kubevirt.io/mca: "true"
    cpu-feature.node.kubevirt.io/mce: "true"
    cpu-feature.node.kubevirt.io/md-clear: "true"
    cpu-feature.node.kubevirt.io/mmx: "true"
    cpu-feature.node.kubevirt.io/movbe: "true"
    cpu-feature.node.kubevirt.io/msr: "true"
    cpu-feature.node.kubevirt.io/mtrr: "true"
    cpu-feature.node.kubevirt.io/nx: "true"
    cpu-feature.node.kubevirt.io/pae: "true"
    cpu-feature.node.kubevirt.io/pat: "true"
    cpu-feature.node.kubevirt.io/pcid: "true"
    cpu-feature.node.kubevirt.io/pclmuldq: "true"
    cpu-feature.node.kubevirt.io/pdcm: "true"
    cpu-feature.node.kubevirt.io/pdpe1gb: "true"
    cpu-feature.node.kubevirt.io/pge: "true"
    cpu-feature.node.kubevirt.io/pni: "true"
    cpu-feature.node.kubevirt.io/popcnt: "true"
    cpu-feature.node.kubevirt.io/pschange-mc-no: "true"
    cpu-feature.node.kubevirt.io/pse: "true"
    cpu-feature.node.kubevirt.io/pse36: "true"
    cpu-feature.node.kubevirt.io/rdrand: "true"
    cpu-feature.node.kubevirt.io/rdtscp: "true"
    cpu-feature.node.kubevirt.io/rfds-no: "true"
    cpu-feature.node.kubevirt.io/sep: "true"
    cpu-feature.node.kubevirt.io/skip-l1dfl-vmentry: "true"
    cpu-feature.node.kubevirt.io/smep: "true"
    cpu-feature.node.kubevirt.io/spec-ctrl: "true"
    cpu-feature.node.kubevirt.io/ss: "true"
    cpu-feature.node.kubevirt.io/ssbd: "true"
    cpu-feature.node.kubevirt.io/sse: "true"
    cpu-feature.node.kubevirt.io/sse2: "true"
    cpu-feature.node.kubevirt.io/sse4.1: "true"
    cpu-feature.node.kubevirt.io/sse4.2: "true"
    cpu-feature.node.kubevirt.io/ssse3: "true"
    cpu-feature.node.kubevirt.io/stibp: "true"
    cpu-feature.node.kubevirt.io/syscall: "true"
    cpu-feature.node.kubevirt.io/tsc: "true"
    cpu-feature.node.kubevirt.io/tsc-deadline: "true"
    cpu-feature.node.kubevirt.io/tsc_adjust: "true"
    cpu-feature.node.kubevirt.io/umip: "true"
    cpu-feature.node.kubevirt.io/vme: "true"
    cpu-feature.node.kubevirt.io/vmx: "true"
    cpu-feature.node.kubevirt.io/vmx-activity-hlt: "true"
    cpu-feature.node.kubevirt.io/vmx-activity-wait-sipi: "true"
    cpu-feature.node.kubevirt.io/vmx-apicv-register: "true"
    cpu-feature.node.kubevirt.io/vmx-apicv-vid: "true"
    cpu-feature.node.kubevirt.io/vmx-apicv-x2apic: "true"
    cpu-feature.node.kubevirt.io/vmx-apicv-xapic: "true"
    cpu-feature.node.kubevirt.io/vmx-cr3-load-noexit: "true"
    cpu-feature.node.kubevirt.io/vmx-cr3-store-noexit: "true"
    cpu-feature.node.kubevirt.io/vmx-cr8-load-exit: "true"
    cpu-feature.node.kubevirt.io/vmx-cr8-store-exit: "true"
    cpu-feature.node.kubevirt.io/vmx-desc-exit: "true"
    cpu-feature.node.kubevirt.io/vmx-entry-ia32e-mode: "true"
    cpu-feature.node.kubevirt.io/vmx-entry-load-efer: "true"
    cpu-feature.node.kubevirt.io/vmx-entry-load-pat: "true"
    cpu-feature.node.kubevirt.io/vmx-entry-load-perf-global-ctrl: "true"
    cpu-feature.node.kubevirt.io/vmx-entry-noload-debugctl: "true"
    cpu-feature.node.kubevirt.io/vmx-ept: "true"
    cpu-feature.node.kubevirt.io/vmx-ept-1gb: "true"
    cpu-feature.node.kubevirt.io/vmx-ept-2mb: "true"
    cpu-feature.node.kubevirt.io/vmx-ept-execonly: "true"
    cpu-feature.node.kubevirt.io/vmx-eptad: "true"
    cpu-feature.node.kubevirt.io/vmx-eptp-switching: "true"
    cpu-feature.node.kubevirt.io/vmx-exit-ack-intr: "true"
    cpu-feature.node.kubevirt.io/vmx-exit-load-efer: "true"
    cpu-feature.node.kubevirt.io/vmx-exit-load-pat: "true"
    cpu-feature.node.kubevirt.io/vmx-exit-load-perf-global-ctrl: "true"
    cpu-feature.node.kubevirt.io/vmx-exit-nosave-debugctl: "true"
    cpu-feature.node.kubevirt.io/vmx-exit-save-efer: "true"
    cpu-feature.node.kubevirt.io/vmx-exit-save-pat: "true"
    cpu-feature.node.kubevirt.io/vmx-exit-save-preemption-timer: "true"
    cpu-feature.node.kubevirt.io/vmx-flexpriority: "true"
    cpu-feature.node.kubevirt.io/vmx-hlt-exit: "true"
    cpu-feature.node.kubevirt.io/vmx-ins-outs: "true"
    cpu-feature.node.kubevirt.io/vmx-intr-exit: "true"
    cpu-feature.node.kubevirt.io/vmx-invept: "true"
    cpu-feature.node.kubevirt.io/vmx-invept-all-context: "true"
    cpu-feature.node.kubevirt.io/vmx-invept-single-context: "true"
    cpu-feature.node.kubevirt.io/vmx-invlpg-exit: "true"
    cpu-feature.node.kubevirt.io/vmx-invpcid-exit: "true"
    cpu-feature.node.kubevirt.io/vmx-invvpid: "true"
    cpu-feature.node.kubevirt.io/vmx-invvpid-all-context: "true"
    cpu-feature.node.kubevirt.io/vmx-invvpid-single-addr: "true"
    cpu-feature.node.kubevirt.io/vmx-invvpid-single-context-noglobals: "true"
    cpu-feature.node.kubevirt.io/vmx-io-bitmap: "true"
    cpu-feature.node.kubevirt.io/vmx-io-exit: "true"
    cpu-feature.node.kubevirt.io/vmx-monitor-exit: "true"
    cpu-feature.node.kubevirt.io/vmx-movdr-exit: "true"
    cpu-feature.node.kubevirt.io/vmx-msr-bitmap: "true"
    cpu-feature.node.kubevirt.io/vmx-mtf: "true"
    cpu-feature.node.kubevirt.io/vmx-mwait-exit: "true"
    cpu-feature.node.kubevirt.io/vmx-nmi-exit: "true"
    cpu-feature.node.kubevirt.io/vmx-page-walk-4: "true"
    cpu-feature.node.kubevirt.io/vmx-pause-exit: "true"
    cpu-feature.node.kubevirt.io/vmx-pml: "true"
    cpu-feature.node.kubevirt.io/vmx-posted-intr: "true"
    cpu-feature.node.kubevirt.io/vmx-preemption-timer: "true"
    cpu-feature.node.kubevirt.io/vmx-rdpmc-exit: "true"
    cpu-feature.node.kubevirt.io/vmx-rdrand-exit: "true"
    cpu-feature.node.kubevirt.io/vmx-rdtsc-exit: "true"
    cpu-feature.node.kubevirt.io/vmx-rdtscp-exit: "true"
    cpu-feature.node.kubevirt.io/vmx-secondary-ctls: "true"
    cpu-feature.node.kubevirt.io/vmx-shadow-vmcs: "true"
    cpu-feature.node.kubevirt.io/vmx-store-lma: "true"
    cpu-feature.node.kubevirt.io/vmx-true-ctls: "true"
    cpu-feature.node.kubevirt.io/vmx-tsc-offset: "true"
    cpu-feature.node.kubevirt.io/vmx-unrestricted-guest: "true"
    cpu-feature.node.kubevirt.io/vmx-vintr-pending: "true"
    cpu-feature.node.kubevirt.io/vmx-vmfunc: "true"
    cpu-feature.node.kubevirt.io/vmx-vmwrite-vmexit-fields: "true"
    cpu-feature.node.kubevirt.io/vmx-vnmi: "true"
    cpu-feature.node.kubevirt.io/vmx-vnmi-pending: "true"
    cpu-feature.node.kubevirt.io/vmx-vpid: "true"
    cpu-feature.node.kubevirt.io/vmx-wbinvd-exit: "true"
    cpu-feature.node.kubevirt.io/x2apic: "true"
    cpu-feature.node.kubevirt.io/xsave: "true"
    cpu-feature.node.kubevirt.io/xsaveopt: "true"
    cpu-model-migration.node.kubevirt.io/Haswell-noTSX: "true"
    cpu-model-migration.node.kubevirt.io/Haswell-noTSX-IBRS: "true"
    cpu-model-migration.node.kubevirt.io/Haswell-v2: "true"
    cpu-model-migration.node.kubevirt.io/Haswell-v4: "true"
    cpu-model-migration.node.kubevirt.io/IvyBridge: "true"
    cpu-model-migration.node.kubevirt.io/IvyBridge-IBRS: "true"
    cpu-model-migration.node.kubevirt.io/IvyBridge-v1: "true"
    cpu-model-migration.node.kubevirt.io/IvyBridge-v2: "true"
    cpu-model-migration.node.kubevirt.io/Nehalem: "true"
    cpu-model-migration.node.kubevirt.io/Nehalem-IBRS: "true"
    cpu-model-migration.node.kubevirt.io/Nehalem-v1: "true"
    cpu-model-migration.node.kubevirt.io/Nehalem-v2: "true"
    cpu-model-migration.node.kubevirt.io/Penryn: "true"
    cpu-model-migration.node.kubevirt.io/Penryn-v1: "true"
    cpu-model-migration.node.kubevirt.io/SandyBridge: "true"
    cpu-model-migration.node.kubevirt.io/SandyBridge-IBRS: "true"
    cpu-model-migration.node.kubevirt.io/SandyBridge-v1: "true"
    cpu-model-migration.node.kubevirt.io/SandyBridge-v2: "true"
    cpu-model-migration.node.kubevirt.io/Westmere: "true"
    cpu-model-migration.node.kubevirt.io/Westmere-IBRS: "true"
    cpu-model-migration.node.kubevirt.io/Westmere-v1: "true"
    cpu-model-migration.node.kubevirt.io/Westmere-v2: "true"
    cpu-model.node.kubevirt.io/Haswell-noTSX: "true"
    cpu-model.node.kubevirt.io/Haswell-noTSX-IBRS: "true"
    cpu-model.node.kubevirt.io/Haswell-v2: "true"
    cpu-model.node.kubevirt.io/Haswell-v4: "true"
    cpu-model.node.kubevirt.io/IvyBridge: "true"
    cpu-model.node.kubevirt.io/IvyBridge-IBRS: "true"
    cpu-model.node.kubevirt.io/IvyBridge-v1: "true"
    cpu-model.node.kubevirt.io/IvyBridge-v2: "true"
    cpu-model.node.kubevirt.io/Nehalem: "true"
    cpu-model.node.kubevirt.io/Nehalem-IBRS: "true"
    cpu-model.node.kubevirt.io/Nehalem-v1: "true"
    cpu-model.node.kubevirt.io/Nehalem-v2: "true"
    cpu-model.node.kubevirt.io/Penryn: "true"
    cpu-model.node.kubevirt.io/Penryn-v1: "true"
    cpu-model.node.kubevirt.io/SandyBridge: "true"
    cpu-model.node.kubevirt.io/SandyBridge-IBRS: "true"
    cpu-model.node.kubevirt.io/SandyBridge-v1: "true"
    cpu-model.node.kubevirt.io/SandyBridge-v2: "true"
    cpu-model.node.kubevirt.io/Westmere: "true"
    cpu-model.node.kubevirt.io/Westmere-IBRS: "true"
    cpu-model.node.kubevirt.io/Westmere-v1: "true"
    cpu-model.node.kubevirt.io/Westmere-v2: "true"
    cpu-vendor.node.kubevirt.io/Intel: "true"
    cpumanager: "false"
    harvesterhci.io/managed: "true"
    host-model-cpu.node.kubevirt.io/Haswell-noTSX-IBRS: "true"
    host-model-required-features.node.kubevirt.io/abm: "true"
    host-model-required-features.node.kubevirt.io/amd-ssbd: "true"
    host-model-required-features.node.kubevirt.io/amd-stibp: "true"
    host-model-required-features.node.kubevirt.io/arat: "true"
    host-model-required-features.node.kubevirt.io/arch-capabilities: "true"
    host-model-required-features.node.kubevirt.io/f16c: "true"
    host-model-required-features.node.kubevirt.io/flush-l1d: "true"
    host-model-required-features.node.kubevirt.io/gds-no: "true"
    host-model-required-features.node.kubevirt.io/hypervisor: "true"
    host-model-required-features.node.kubevirt.io/ibpb: "true"
    host-model-required-features.node.kubevirt.io/ibrs: "true"
    host-model-required-features.node.kubevirt.io/md-clear: "true"
    host-model-required-features.node.kubevirt.io/pdcm: "true"
    host-model-required-features.node.kubevirt.io/pdpe1gb: "true"
    host-model-required-features.node.kubevirt.io/pschange-mc-no: "true"
    host-model-required-features.node.kubevirt.io/rdrand: "true"
    host-model-required-features.node.kubevirt.io/rfds-no: "true"
    host-model-required-features.node.kubevirt.io/skip-l1dfl-vmentry: "true"
    host-model-required-features.node.kubevirt.io/ss: "true"
    host-model-required-features.node.kubevirt.io/ssbd: "true"
    host-model-required-features.node.kubevirt.io/stibp: "true"
    host-model-required-features.node.kubevirt.io/tsc_adjust: "true"
    host-model-required-features.node.kubevirt.io/umip: "true"
    host-model-required-features.node.kubevirt.io/vme: "true"
    host-model-required-features.node.kubevirt.io/vmx: "true"
    host-model-required-features.node.kubevirt.io/vmx-activity-hlt: "true"
    host-model-required-features.node.kubevirt.io/vmx-activity-wait-sipi: "true"
    host-model-required-features.node.kubevirt.io/vmx-apicv-register: "true"
    host-model-required-features.node.kubevirt.io/vmx-apicv-vid: "true"
    host-model-required-features.node.kubevirt.io/vmx-apicv-x2apic: "true"
    host-model-required-features.node.kubevirt.io/vmx-apicv-xapic: "true"
    host-model-required-features.node.kubevirt.io/vmx-cr3-load-noexit: "true"
    host-model-required-features.node.kubevirt.io/vmx-cr3-store-noexit: "true"
    host-model-required-features.node.kubevirt.io/vmx-cr8-load-exit: "true"
    host-model-required-features.node.kubevirt.io/vmx-cr8-store-exit: "true"
    host-model-required-features.node.kubevirt.io/vmx-desc-exit: "true"
    host-model-required-features.node.kubevirt.io/vmx-entry-ia32e-mode: "true"
    host-model-required-features.node.kubevirt.io/vmx-entry-load-efer: "true"
    host-model-required-features.node.kubevirt.io/vmx-entry-load-pat: "true"
    host-model-required-features.node.kubevirt.io/vmx-entry-load-perf-global-ctrl: "true"
    host-model-required-features.node.kubevirt.io/vmx-entry-noload-debugctl: "true"
    host-model-required-features.node.kubevirt.io/vmx-ept: "true"
    host-model-required-features.node.kubevirt.io/vmx-ept-1gb: "true"
    host-model-required-features.node.kubevirt.io/vmx-ept-2mb: "true"
    host-model-required-features.node.kubevirt.io/vmx-ept-execonly: "true"
    host-model-required-features.node.kubevirt.io/vmx-eptad: "true"
    host-model-required-features.node.kubevirt.io/vmx-eptp-switching: "true"
    host-model-required-features.node.kubevirt.io/vmx-exit-ack-intr: "true"
    host-model-required-features.node.kubevirt.io/vmx-exit-load-efer: "true"
    host-model-required-features.node.kubevirt.io/vmx-exit-load-pat: "true"
    host-model-required-features.node.kubevirt.io/vmx-exit-load-perf-global-ctrl: "true"
    host-model-required-features.node.kubevirt.io/vmx-exit-nosave-debugctl: "true"
    host-model-required-features.node.kubevirt.io/vmx-exit-save-efer: "true"
    host-model-required-features.node.kubevirt.io/vmx-exit-save-pat: "true"
    host-model-required-features.node.kubevirt.io/vmx-exit-save-preemption-timer: "true"
    host-model-required-features.node.kubevirt.io/vmx-flexpriority: "true"
    host-model-required-features.node.kubevirt.io/vmx-hlt-exit: "true"
    host-model-required-features.node.kubevirt.io/vmx-ins-outs: "true"
    host-model-required-features.node.kubevirt.io/vmx-intr-exit: "true"
    host-model-required-features.node.kubevirt.io/vmx-invept: "true"
    host-model-required-features.node.kubevirt.io/vmx-invept-all-context: "true"
    host-model-required-features.node.kubevirt.io/vmx-invept-single-context: "true"
    host-model-required-features.node.kubevirt.io/vmx-invlpg-exit: "true"
    host-model-required-features.node.kubevirt.io/vmx-invpcid-exit: "true"
    host-model-required-features.node.kubevirt.io/vmx-invvpid: "true"
    host-model-required-features.node.kubevirt.io/vmx-invvpid-all-context: "true"
    host-model-required-features.node.kubevirt.io/vmx-invvpid-single-addr: "true"
    host-model-required-features.node.kubevirt.io/vmx-invvpid-single-context-noglobals: "true"
    host-model-required-features.node.kubevirt.io/vmx-io-bitmap: "true"
    host-model-required-features.node.kubevirt.io/vmx-io-exit: "true"
    host-model-required-features.node.kubevirt.io/vmx-monitor-exit: "true"
    host-model-required-features.node.kubevirt.io/vmx-movdr-exit: "true"
    host-model-required-features.node.kubevirt.io/vmx-msr-bitmap: "true"
    host-model-required-features.node.kubevirt.io/vmx-mtf: "true"
    host-model-required-features.node.kubevirt.io/vmx-mwait-exit: "true"
    host-model-required-features.node.kubevirt.io/vmx-nmi-exit: "true"
    host-model-required-features.node.kubevirt.io/vmx-page-walk-4: "true"
    host-model-required-features.node.kubevirt.io/vmx-pause-exit: "true"
    host-model-required-features.node.kubevirt.io/vmx-pml: "true"
    host-model-required-features.node.kubevirt.io/vmx-posted-intr: "true"
    host-model-required-features.node.kubevirt.io/vmx-preemption-timer: "true"
    host-model-required-features.node.kubevirt.io/vmx-rdpmc-exit: "true"
    host-model-required-features.node.kubevirt.io/vmx-rdrand-exit: "true"
    host-model-required-features.node.kubevirt.io/vmx-rdtsc-exit: "true"
    host-model-required-features.node.kubevirt.io/vmx-rdtscp-exit: "true"
    host-model-required-features.node.kubevirt.io/vmx-secondary-ctls: "true"
    host-model-required-features.node.kubevirt.io/vmx-shadow-vmcs: "true"
    host-model-required-features.node.kubevirt.io/vmx-store-lma: "true"
    host-model-required-features.node.kubevirt.io/vmx-true-ctls: "true"
    host-model-required-features.node.kubevirt.io/vmx-tsc-offset: "true"
    host-model-required-features.node.kubevirt.io/vmx-unrestricted-guest: "true"
    host-model-required-features.node.kubevirt.io/vmx-vintr-pending: "true"
    host-model-required-features.node.kubevirt.io/vmx-vmfunc: "true"
    host-model-required-features.node.kubevirt.io/vmx-vmwrite-vmexit-fields: "true"
    host-model-required-features.node.kubevirt.io/vmx-vnmi: "true"
    host-model-required-features.node.kubevirt.io/vmx-vnmi-pending: "true"
    host-model-required-features.node.kubevirt.io/vmx-vpid: "true"
    host-model-required-features.node.kubevirt.io/vmx-wbinvd-exit: "true"
    host-model-required-features.node.kubevirt.io/xsaveopt: "true"
    hyperv.node.kubevirt.io/base: "true"
    hyperv.node.kubevirt.io/frequencies: "true"
    hyperv.node.kubevirt.io/ipi: "true"
    hyperv.node.kubevirt.io/reenlightenment: "true"
    hyperv.node.kubevirt.io/reset: "true"
    hyperv.node.kubevirt.io/runtime: "true"
    hyperv.node.kubevirt.io/synic: "true"
    hyperv.node.kubevirt.io/synic2: "true"
    hyperv.node.kubevirt.io/synictimer: "true"
    hyperv.node.kubevirt.io/time: "true"
    hyperv.node.kubevirt.io/tlbflush: "true"
    hyperv.node.kubevirt.io/vpindex: "true"
    kubernetes.io/arch: amd64
    kubernetes.io/hostname: harvester-node-1
    kubernetes.io/os: linux
    kubevirt.io/ksm-enabled: "false"
    kubevirt.io/schedulable: "false"
    machine-type.node.kubevirt.io/isapc: "true"
    machine-type.node.kubevirt.io/microvm: "true"
    machine-type.node.kubevirt.io/nitro-enclave: "true"
    machine-type.node.kubevirt.io/pc: "true"
    machine-type.node.kubevirt.io/pc-i440fx-2.4: "true"
    machine-type.node.kubevirt.io/pc-i440fx-2.5: "true"
    machine-type.node.kubevirt.io/pc-i440fx-2.6: "true"
    machine-type.node.kubevirt.io/pc-i440fx-2.7: "true"
    machine-type.node.kubevirt.io/pc-i440fx-2.8: "true"
    machine-type.node.kubevirt.io/pc-i440fx-2.9: "true"
    machine-type.node.kubevirt.io/pc-i440fx-2.10: "true"
    machine-type.node.kubevirt.io/pc-i440fx-2.11: "true"
    machine-type.node.kubevirt.io/pc-i440fx-2.12: "true"
    machine-type.node.kubevirt.io/pc-i440fx-3.0: "true"
    machine-type.node.kubevirt.io/pc-i440fx-3.1: "true"
    machine-type.node.kubevirt.io/pc-i440fx-4.0: "true"
    machine-type.node.kubevirt.io/pc-i440fx-4.1: "true"
    machine-type.node.kubevirt.io/pc-i440fx-4.2: "true"
    machine-type.node.kubevirt.io/pc-i440fx-5.0: "true"
    machine-type.node.kubevirt.io/pc-i440fx-5.1: "true"
    machine-type.node.kubevirt.io/pc-i440fx-5.2: "true"
    machine-type.node.kubevirt.io/pc-i440fx-6.0: "true"
    machine-type.node.kubevirt.io/pc-i440fx-6.1: "true"
    machine-type.node.kubevirt.io/pc-i440fx-6.2: "true"
    machine-type.node.kubevirt.io/pc-i440fx-7.0: "true"
    machine-type.node.kubevirt.io/pc-i440fx-7.1: "true"
    machine-type.node.kubevirt.io/pc-i440fx-7.2: "true"
    machine-type.node.kubevirt.io/pc-i440fx-8.0: "true"
    machine-type.node.kubevirt.io/pc-i440fx-8.1: "true"
    machine-type.node.kubevirt.io/pc-i440fx-8.2: "true"
    machine-type.node.kubevirt.io/pc-i440fx-9.0: "true"
    machine-type.node.kubevirt.io/pc-i440fx-9.1: "true"
    machine-type.node.kubevirt.io/pc-i440fx-9.2: "true"
    machine-type.node.kubevirt.io/pc-q35-2.4: "true"
    machine-type.node.kubevirt.io/pc-q35-2.5: "true"
    machine-type.node.kubevirt.io/pc-q35-2.6: "true"
    machine-type.node.kubevirt.io/pc-q35-2.7: "true"
    machine-type.node.kubevirt.io/pc-q35-2.8: "true"
    machine-type.node.kubevirt.io/pc-q35-2.9: "true"
    machine-type.node.kubevirt.io/pc-q35-2.10: "true"
    machine-type.node.kubevirt.io/pc-q35-2.11: "true"
    machine-type.node.kubevirt.io/pc-q35-2.12: "true"
    machine-type.node.kubevirt.io/pc-q35-3.0: "true"
    machine-type.node.kubevirt.io/pc-q35-3.1: "true"
    machine-type.node.kubevirt.io/pc-q35-4.0: "true"
    machine-type.node.kubevirt.io/pc-q35-4.0.1: "true"
    machine-type.node.kubevirt.io/pc-q35-4.1: "true"
    machine-type.node.kubevirt.io/pc-q35-4.2: "true"
    machine-type.node.kubevirt.io/pc-q35-5.0: "true"
    machine-type.node.kubevirt.io/pc-q35-5.1: "true"
    machine-type.node.kubevirt.io/pc-q35-5.2: "true"
    machine-type.node.kubevirt.io/pc-q35-6.0: "true"
    machine-type.node.kubevirt.io/pc-q35-6.1: "true"
    machine-type.node.kubevirt.io/pc-q35-6.2: "true"
    machine-type.node.kubevirt.io/pc-q35-7.0: "true"
    machine-type.node.kubevirt.io/pc-q35-7.1: "true"
    machine-type.node.kubevirt.io/pc-q35-7.2: "true"
    machine-type.node.kubevirt.io/pc-q35-8.0: "true"
    machine-type.node.kubevirt.io/pc-q35-8.1: "true"
    machine-type.node.kubevirt.io/pc-q35-8.2: "true"
    machine-type.node.kubevirt.io/pc-q35-9.0: "true"
    machine-type.node.kubevirt.io/pc-q35-9.1: "true"
    machine-type.node.kubevirt.io/pc-q35-9.2: "true"
    machine-type.node.kubevirt.io/q35: "true"
    machine-type.node.kubevirt.io/xenfv: "true"
    machine-type.node.kubevirt.io/xenfv-3.1: "true"
    machine-type.node.kubevirt.io/xenfv-4.2: "true"
    machine-type.node.kubevirt.io/xenpv: "true"
    machine-type.node.kubevirt.io/xenpvh: "true"
    network.harvesterhci.io/cn: "true"
    network.harvesterhci.io/mgmt: "true"
    network.harvesterhci.io/vlanconfig: nc
    node-role.kubernetes.io/control-plane: "true"
    node-role.kubernetes.io/etcd: "true"
    node.kubernetes.io/instance-type: rke2
    plan.upgrade.cattle.io/sync-additional-ca: 2c27af4f7e139d7c15346edc0adb200edade07eef796ef2c41ef923b
    plan.upgrade.cattle.io/system-agent-upgrader: cab0e3bd454d91beec8ee44425add5c2cd494696a84c38239deb82f1
    rke.cattle.io/machine: d4669472-188d-42e6-86cc-e4b2ddf76c88
  name: harvester-node-1
  resourceVersion: "5610701"
  uid: 9221811e-1f0e-4958-9aba-468444971fcb
spec:
  podCIDR: 10.52.1.0/24
  podCIDRs:
  - 10.52.1.0/24
  providerID: rke2://harvester-node-1
  taints:
  - effect: NoSchedule
    key: node.kubernetes.io/unreachable
    timeAdded: "2026-01-19T05:36:00Z"
  - effect: NoExecute
    key: node.kubernetes.io/unreachable
    timeAdded: "2026-01-19T05:36:00Z"
  - effect: NoSchedule
    key: kubevirt.io/drain
  - effect: NoExecute
    key: node.kubernetes.io/out-of-service
status:
  addresses:
  - address: 10.115.52.90
    type: InternalIP
  - address: harvester-node-1
    type: Hostname
  allocatable:
    cpu: "11"
    devices.kubevirt.io/kvm: 1k
    devices.kubevirt.io/tun: 1k
    devices.kubevirt.io/vhost-net: 1k
    ephemeral-storage: "276921388020"
    hugepages-1Gi: "0"
    hugepages-2Mi: "0"
    memory: 22392912Ki
    pods: "200"
  capacity:
    cpu: "12"
    devices.kubevirt.io/kvm: 1k
    devices.kubevirt.io/tun: 1k
    devices.kubevirt.io/vhost-net: 1k
    ephemeral-storage: 284664256Ki
    hugepages-1Gi: "0"
    hugepages-2Mi: "0"
    memory: 22392912Ki
    pods: "200"
  conditions:
  - lastHeartbeatTime: "2026-01-20T22:55:24Z"
    lastTransitionTime: "2026-01-16T02:57:23Z"
    message: Node is a voting member of the etcd cluster
    reason: MemberNotLearner
    status: "True"
    type: EtcdIsVoter
  - lastHeartbeatTime: "2026-01-16T02:53:47Z"
    lastTransitionTime: "2026-01-16T02:53:47Z"
    message: Flannel is running on this node
    reason: FlannelIsUp
    status: "False"
    type: NetworkUnavailable
  - lastHeartbeatTime: "2026-01-19T05:31:34Z"
    lastTransitionTime: "2026-01-19T05:36:00Z"
    message: Kubelet stopped posting node status.
    reason: NodeStatusUnknown
    status: Unknown
    type: MemoryPressure
  - lastHeartbeatTime: "2026-01-19T05:31:34Z"
    lastTransitionTime: "2026-01-19T05:36:00Z"
    message: Kubelet stopped posting node status.
    reason: NodeStatusUnknown
    status: Unknown
    type: DiskPressure
  - lastHeartbeatTime: "2026-01-19T05:31:34Z"
    lastTransitionTime: "2026-01-19T05:36:00Z"
    message: Kubelet stopped posting node status.
    reason: NodeStatusUnknown
    status: Unknown
    type: PIDPressure
  - lastHeartbeatTime: "2026-01-19T05:31:34Z"
    lastTransitionTime: "2026-01-19T05:36:00Z"
    message: Kubelet stopped posting node status.
    reason: NodeStatusUnknown
    status: Unknown
    type: Ready
  daemonEndpoints:
    kubeletEndpoint:
      Port: 10250
  features:
    supplementalGroupsPolicy: true
  images:
  - names:
    - docker.io/rancher/rancher:v2.13.0
    sizeBytes: 1780569233
  - names:
    - docker.io/longhornio/longhorn-instance-manager:v1.10.1
    sizeBytes: 1358647745
  - names:
    - docker.io/rancher/rancher-agent:v2.13.0
    sizeBytes: 840070356
  - names:
    - docker.io/kubeovn/kube-ovn:v1.14.10
    sizeBytes: 766595147
  - names:
    - registry.suse.com/suse/sles/15.7/libguestfs-tools:1.6.3-150700.3.13.1
    sizeBytes: 719820434
  - names:
    - docker.io/rancher/nginx-ingress-controller:v1.13.4-hardened1
    sizeBytes: 707490001
  - names:
    - docker.io/rancher/hardened-calico:v3.30.3-build20251015
    sizeBytes: 685524019
  - names:
    - docker.io/rancher/hardened-kubernetes:v1.34.2-rke2r1-build20251112
    sizeBytes: 640304363
  - names:
    - docker.io/rancher/mirrored-grafana-grafana:11.5.5
    sizeBytes: 595775533
  - names:
    - docker.io/rancher/harvester-upgrade:f601d3a5
    - docker.io/rancher/harvester-upgrade:v1.7-f601d3a5-head
    - docker.io/rancher/harvester-upgrade:v1.7-head
    sizeBytes: 539380404
  - names:
    - registry.suse.com/suse/sles/15.7/virt-launcher:1.6.3-150700.3.13.1
    sizeBytes: 536303999
  - names:
    - docker.io/longhornio/longhorn-engine:v1.10.1
    sizeBytes: 401541994
  - names:
    - docker.io/longhornio/backing-image-manager:v1.10.1
    sizeBytes: 396337321
  - names:
    - docker.io/rancher/mirrored-kube-logging-fluentd:v1.16-4.10-full
    sizeBytes: 388373272
  - names:
    - docker.io/rancher/shell:v0.6.0
    sizeBytes: 361840174
  - names:
    - docker.io/rancher/shell:v0.5.0
    sizeBytes: 353043502
  - names:
    - registry.suse.com/suse/sles/15.7/cdi-importer:1.62.0-150700.9.3.1
    sizeBytes: 344543711
  - names:
    - docker.io/longhornio/longhorn-manager:v1.10.1-hotfix-2
    sizeBytes: 340198509
  - names:
    - docker.io/rancher/harvester:v1.7-head
    sizeBytes: 338368313
  - names:
    - docker.io/longhornio/longhorn-manager:v1.10.1
    sizeBytes: 330481257
  - names:
    - docker.io/rancher/fleet:v0.14.0
    sizeBytes: 319225891
  - names:
    - docker.io/rancher/rke2-runtime:v1.34.2-rke2r1
    sizeBytes: 306299220
  - names:
    - docker.io/rancher/prom-prometheus:v3.2.1
    sizeBytes: 296367903
  - names:
    - docker.io/rancher/harvester-vm-import-controller:v1.7.0
    sizeBytes: 293606461
  - names:
    - docker.io/rancher/harvester-pcidevices:v1.7.0
    sizeBytes: 266649560
  - names:
    - docker.io/longhornio/longhorn-cli:v1.10.1
    sizeBytes: 255924943
  - names:
    - registry.suse.com/suse/sles/15.7/virt-handler:1.6.3-150700.3.13.1
    sizeBytes: 254717336
  - names:
    - docker.io/rancher/harvester-webhook:v1.7-head
    sizeBytes: 251790207
  - names:
    - docker.io/rancher/kuberlr-kubectl:v5.0.0
    sizeBytes: 251571844
  - names:
    - docker.io/rancher/support-bundle-kit:v0.0.74
    sizeBytes: 251150429
  - names:
    - docker.io/longhornio/support-bundle-kit:v0.0.71
    sizeBytes: 251072091
  - names:
    - docker.io/longhornio/longhorn-share-manager:v1.10.1
    sizeBytes: 241758234
  - names:
    - docker.io/rancher/harvester-seeder:v1.7.0
    sizeBytes: 229291817
  - names:
    - docker.io/rancher/system-agent:v0.3.14-suc
    sizeBytes: 218366310
  - names:
    - docker.io/longhornio/longhorn-ui:v1.10.1
    sizeBytes: 215792836
  - names:
    - docker.io/rancher/harvester-networkfs-manager:v1.7.0
    sizeBytes: 213212315
  - names:
    - docker.io/rancher/harvester-network-controller:v1.7.0
    sizeBytes: 211940539
  - names:
    - docker.io/rancher/harvester-kubeovn-operator:v1.14.10-dev.1
    sizeBytes: 211835920
  - names:
    - registry.suse.com/suse/sles/15.7/cdi-uploadserver:1.62.0-150700.9.3.1
    sizeBytes: 207361342
  - names:
    - docker.io/rancher/harvester-node-disk-manager:v1.7.0
    sizeBytes: 206875815
  - names:
    - registry.suse.com/suse/sles/15.7/virt-operator:1.6.3-150700.3.13.1
    sizeBytes: 205596893
  - names:
    - ghcr.io/k8snetworkplumbingwg/whereabouts:v0.9.2
    sizeBytes: 204231357
  - names:
    - registry.suse.com/suse/sles/15.7/virt-api:1.6.3-150700.3.13.1
    sizeBytes: 203198557
  - names:
    - registry.suse.com/suse/sles/15.7/virt-controller:1.6.3-150700.3.13.1
    sizeBytes: 201155368
  - names:
    - registry.suse.com/suse/sles/15.7/cdi-operator:1.62.0-150700.9.3.1
    sizeBytes: 199075883
  - names:
    - registry.suse.com/suse/sles/15.7/cdi-apiserver:1.62.0-150700.9.3.1
    sizeBytes: 190692258
  - names:
    - docker.io/rancher/harvester-cluster-repo:v1.7
    sizeBytes: 190290810
  - names:
    - registry.suse.com/suse/sles/15.7/cdi-uploadproxy:1.62.0-150700.9.3.1
    sizeBytes: 186396854
  - names:
    - registry.suse.com/suse/sles/15.7/cdi-controller:1.62.0-150700.9.3.1
    sizeBytes: 181657246
  - names:
    - docker.io/rancher/harvester-node-manager-webhook:v1.7.0
    sizeBytes: 181319813
  nodeInfo:
    architecture: amd64
    bootID: 1fb1d6b3-5771-4432-a59a-4ca2b2f7ee45
    containerRuntimeVersion: containerd://2.1.5-k3s1
    kernelVersion: 6.4.0-36-default
    kubeProxyVersion: ""
    kubeletVersion: v1.34.2+rke2r1
    machineID: 17b6fa03558170feeadfa60a6969a7c8
    operatingSystem: linux
    osImage: Harvester v1.7
    systemUUID: 7852851b-0094-4fb5-be77-37e48cf502fd
  runtimeHandlers:
  - features:
      recursiveReadOnlyMounts: true
      userNamespaces: true
    name: ""
  - features:
      recursiveReadOnlyMounts: true
      userNamespaces: true
    name: runc
  - features:
      recursiveReadOnlyMounts: false
      userNamespaces: false
    name: runhcs-wcow-process`
)

func Test_UpdateStatusAnnotations(t *testing.T) {
	testCases := []struct {
		Name            string
		NodeObject      string
		ExpectCondition bool
	}{
		{
			Name:            "node with drain condition true",
			NodeObject:      nodeConditionTrue,
			ExpectCondition: true,
		},
		{
			Name:            "node with drain condition false",
			NodeObject:      nodeConditionFalse,
			ExpectCondition: false,
		},
		{
			Name:            "node with drain condition missing",
			NodeObject:      nodeWithNoCondition,
			ExpectCondition: false,
		},
	}

	for _, tc := range testCases {
		assert := require.New(t)
		nodeObj, err := generateNodeObject(tc.NodeObject)
		assert.NoError(err, "expected no error during generation of node object")
		k8sclientset := k8sfake.NewSimpleClientset(nodeObj)
		nodeClient := fakeclients.NodeClient(k8sclientset.CoreV1().Nodes)
		cm := &ConditionManager{
			nodeClient: nodeClient,
		}
		updatedNodeObject, err := cm.UpdateStatusAnnotations(nodeObj.Name, nodeObj)
		assert.NoError(err, "expected no error during execution of UpdateStatusAnnotations")
		_, conditionKeyOK := updatedNodeObject.Annotations[util.HarvesterReportedConditionKey]
		_, conditionMessageKeyOK := updatedNodeObject.Annotations[util.HarvesterReportedConditionMessageKey]
		if tc.ExpectCondition {
			assert.True(conditionKeyOK, "expected to find condition key on node object in test case: %s", tc.Name)
			assert.True(conditionMessageKeyOK, "expected to find condition message key on node object in test case: %s", tc.Name)
		} else {
			assert.False(conditionKeyOK, "expected to not find condition key on node object in test case: %s", tc.Name)
			assert.False(conditionMessageKeyOK, "expected to not find condition message key on node object in test case: %s", tc.Name)
		}
	}
}

func generateNodeObject(nodeString string) (*corev1.Node, error) {
	nodeObj := &corev1.Node{}
	err := yaml.Unmarshal([]byte(nodeString), nodeObj)
	if err != nil {
		return nil, err
	}
	return nodeObj, nil
}
